(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{270:function(e){e.exports={main:{name:"main",remote:null,live:!1,retry:!1},messages:{name:"messages",remote:"http://localhost:8080/db/messages",live:!0,retry:!1},"message-types":{name:"message-types",remote:null,live:!1,retry:!1},"rewind-points":{name:"rewind-points",remote:"http://localhost:8080//db/rewind-points",live:!0,retry:!1}}},273:function(e){e.exports={$ref:"#/definitions/object",title:"object type",definitions:{string:{required:["type"],defaultProperties:["type","title"],additionalProperties:!1,title:"string type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"string"},format:{type:"string",enum:["color","date","datetime","datetime-local","email","month","number","range","tel","text","textarea","time","url","week","json","sql","xml","yaml"]},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},title:{type:"string",propertyOrder:1},type:{options:{hidden:!0},type:"string",enum:["string"]},enum:{format:"table",items:{title:"alternative",type:"string"},type:"array"},description:{type:"string"}}},null:{required:["type"],defaultProperties:["type","title"],additionalProperties:!1,title:"null type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"null"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},title:{type:"string",propertyOrder:1},type:{options:{hidden:!0},type:"string",enum:["null"]},description:{type:"string"}}},array:{required:["type"],defaultProperties:["type","items","title"],additionalProperties:!1,title:"array type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"array"},format:{default:"table",type:"string",enum:["array","table","tabs","tabs-top","checkbox","select","categories"]},items:{$ref:"#/definitions/schema"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},title:{type:"string",propertyOrder:1},type:{options:{hidden:!0},type:"string",enum:["array"]},description:{type:"string"}}},schema:{default:{type:"object"},oneOf:[{$ref:"#/definitions/null",title:"null type"},{$ref:"#/definitions/boolean",title:"boolean type"},{$ref:"#/definitions/string",title:"string type"},{$ref:"#/definitions/integer",title:"integer type"},{$ref:"#/definitions/number",title:"number type"},{$ref:"#/definitions/object",title:"object type"},{$ref:"#/definitions/array",title:"array type"}],options:{keep_oneof_values:!1},type:"object"},boolean:{required:["type"],defaultProperties:["type","title"],additionalProperties:!1,title:"boolean type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"boolean"},format:{type:"string",enum:["select","checkbox"]},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},title:{type:"string",propertyOrder:1},type:{options:{hidden:!0},type:"string",enum:["boolean"]},description:{type:"string"}}},object:{required:["type"],defaultProperties:["type","properties","title"],additionalProperties:!1,title:"object type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"object"},format:{type:"string",enum:["grid"]},required:{uniqueItems:!0,format:"table",items:{title:"property",type:"string"},type:"array"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},title:{type:"string",propertyOrder:1},type:{options:{hidden:!0},type:"string",enum:["object"]},description:{type:"string"},properties:{type:"object",patternProperties:{".*":{$ref:"#/definitions/propertySchema"}}}}},number:{required:["type"],defaultProperties:["type","title"],additionalProperties:!1,title:"number type",type:"object",properties:{$ref:{format:"uri",type:"string"},maximum:{type:"number"},default:{type:"number"},minimum:{type:"number"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},title:{type:"string",propertyOrder:1},type:{options:{hidden:!0},type:"string",enum:["number"]},enum:{format:"table",items:{title:"alternative",type:"number"},type:"array"},description:{type:"string"}}},integer:{required:["type"],defaultProperties:["type","title"],additionalProperties:!1,title:"integer type",type:"object",properties:{$ref:{format:"uri",type:"string"},maximum:{type:"integer"},default:{type:"integer"},minimum:{type:"integer"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},title:{type:"string",propertyOrder:1},type:{options:{hidden:!0},type:"string",enum:["integer"]},enum:{format:"table",items:{title:"alternative",type:"integer"},type:"array"},description:{type:"string"}}},propertySchema:{default:{type:"object"},oneOf:[{required:["type"],defaultProperties:["type"],additionalProperties:!1,title:"null type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"null"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},type:{options:{hidden:!0},type:"string",enum:["null"]},description:{type:"string"}}},{required:["type"],defaultProperties:["type"],additionalProperties:!1,title:"boolean type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"boolean"},format:{type:"string",enum:["select","checkbox"]},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},type:{options:{hidden:!0},type:"string",enum:["boolean"]},description:{type:"string"}}},{required:["type"],defaultProperties:["type"],additionalProperties:!1,title:"string type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"string"},format:{type:"string",enum:["color","date","datetime","datetime-local","email","month","number","range","tel","text","textarea","time","url","week","json","sql","xml","yaml"]},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},type:{options:{hidden:!0},type:"string",enum:["string"]},enum:{format:"table",items:{title:"alternative",type:"string"},type:"array"},description:{type:"string"}}},{required:["type"],defaultProperties:["type"],additionalProperties:!1,title:"integer type",type:"object",properties:{$ref:{format:"uri",type:"string"},maximum:{type:"integer"},default:{type:"integer"},minimum:{type:"integer"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},type:{options:{hidden:!0},type:"string",enum:["integer"]},enum:{format:"table",items:{title:"alternative",type:"integer"},type:"array"},description:{type:"string"}}},{required:["type"],defaultProperties:["type"],additionalProperties:!1,title:"number type",type:"object",properties:{$ref:{format:"uri",type:"string"},maximum:{type:"number"},default:{type:"number"},minimum:{type:"number"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},type:{options:{hidden:!0},type:"string",enum:["number"]},enum:{format:"table",items:{title:"alternative",type:"number"},type:"array"},description:{type:"string"}}},{required:["type"],defaultProperties:["type","properties"],additionalProperties:!1,title:"object type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"object"},format:{type:"string",enum:["grid"]},required:{uniqueItems:!0,format:"table",items:{title:"property",type:"string"},type:"array"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},type:{options:{hidden:!0},type:"string",enum:["object"]},description:{type:"string"},properties:{type:"object",patternProperties:{".*":{$ref:"#/definitions/propertySchema"}}}}},{required:["type"],defaultProperties:["type","items"],additionalProperties:!1,title:"array type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"array"},format:{default:"table",type:"string",enum:["array","table","tabs","tabs-top","checkbox","select","categories"]},items:{$ref:"#/definitions/schema"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},type:{options:{hidden:!0},type:"string",enum:["array"]},description:{type:"string"}}}],options:{keep_oneof_values:!1},type:"object"}}}},278:function(e,t,a){e.exports=a(320)},301:function(e){e.exports={main:{name:"main",remote:null,live:!1,retry:!1},messages:{name:"messages",remote:"http://localhost:8080/db/messages",live:!0,retry:!1},"message-types":{name:"message-types",remote:null,live:!1,retry:!1},"rewind-points":{name:"rewind-points",remote:"http://localhost:8080//db/rewind-points",live:!0,retry:!1}}},303:function(e,t,a){var r={"./abap":72,"./abap.js":72,"./abc":73,"./abc.js":73,"./actionscript":74,"./actionscript.js":74,"./ada":75,"./ada.js":75,"./apache_conf":76,"./apache_conf.js":76,"./applescript":77,"./applescript.js":77,"./asciidoc":78,"./asciidoc.js":78,"./assembly_x86":79,"./assembly_x86.js":79,"./autohotkey":80,"./autohotkey.js":80,"./batchfile":81,"./batchfile.js":81,"./bro":82,"./bro.js":82,"./c9search":83,"./c9search.js":83,"./c_cpp":84,"./c_cpp.js":84,"./cirru":85,"./cirru.js":85,"./clojure":86,"./clojure.js":86,"./cobol":87,"./cobol.js":87,"./coffee":88,"./coffee.js":88,"./coldfusion":89,"./coldfusion.js":89,"./csharp":90,"./csharp.js":90,"./csound_document":91,"./csound_document.js":91,"./csound_orchestra":92,"./csound_orchestra.js":92,"./csound_score":93,"./csound_score.js":93,"./css":94,"./css.js":94,"./curly":95,"./curly.js":95,"./d":96,"./d.js":96,"./dart":97,"./dart.js":97,"./diff":98,"./diff.js":98,"./django":99,"./django.js":99,"./dockerfile":100,"./dockerfile.js":100,"./dot":101,"./dot.js":101,"./drools":102,"./drools.js":102,"./eiffel":103,"./eiffel.js":103,"./ejs":104,"./ejs.js":104,"./elixir":105,"./elixir.js":105,"./elm":106,"./elm.js":106,"./erlang":107,"./erlang.js":107,"./forth":108,"./forth.js":108,"./fortran":109,"./fortran.js":109,"./ftl":110,"./ftl.js":110,"./gcode":111,"./gcode.js":111,"./gherkin":112,"./gherkin.js":112,"./gitignore":113,"./gitignore.js":113,"./glsl":114,"./glsl.js":114,"./gobstones":115,"./gobstones.js":115,"./golang":116,"./golang.js":116,"./graphqlschema":117,"./graphqlschema.js":117,"./groovy":118,"./groovy.js":118,"./haml":119,"./haml.js":119,"./handlebars":120,"./handlebars.js":120,"./haskell":121,"./haskell.js":121,"./haskell_cabal":122,"./haskell_cabal.js":122,"./haxe":123,"./haxe.js":123,"./hjson":124,"./hjson.js":124,"./html":125,"./html.js":125,"./html_elixir":126,"./html_elixir.js":126,"./html_ruby":127,"./html_ruby.js":127,"./ini":128,"./ini.js":128,"./io":129,"./io.js":129,"./jack":130,"./jack.js":130,"./jade":131,"./jade.js":131,"./java":132,"./java.js":132,"./javascript":133,"./javascript.js":133,"./json":134,"./json.js":134,"./jsoniq":135,"./jsoniq.js":135,"./jsp":136,"./jsp.js":136,"./jssm":137,"./jssm.js":137,"./jsx":138,"./jsx.js":138,"./julia":139,"./julia.js":139,"./kotlin":140,"./kotlin.js":140,"./latex":141,"./latex.js":141,"./lean":142,"./lean.js":142,"./less":143,"./less.js":143,"./liquid":144,"./liquid.js":144,"./lisp":145,"./lisp.js":145,"./live_script":146,"./live_script.js":146,"./livescript":147,"./livescript.js":147,"./logiql":148,"./logiql.js":148,"./lsl":149,"./lsl.js":149,"./lua":150,"./lua.js":150,"./luapage":152,"./luapage.js":152,"./lucene":153,"./lucene.js":153,"./makefile":154,"./makefile.js":154,"./markdown":155,"./markdown.js":155,"./mask":156,"./mask.js":156,"./matlab":157,"./matlab.js":157,"./mavens_mate_log":158,"./mavens_mate_log.js":158,"./maze":159,"./maze.js":159,"./mel":160,"./mel.js":160,"./mips_assembler":161,"./mips_assembler.js":161,"./mipsassembler":162,"./mipsassembler.js":162,"./mushcode":163,"./mushcode.js":163,"./mysql":164,"./mysql.js":164,"./nix":165,"./nix.js":165,"./nsis":166,"./nsis.js":166,"./objectivec":167,"./objectivec.js":167,"./ocaml":168,"./ocaml.js":168,"./pascal":169,"./pascal.js":169,"./perl":170,"./perl.js":170,"./pgsql":171,"./pgsql.js":171,"./php":172,"./php.js":172,"./pig":173,"./pig.js":173,"./plain_text":174,"./plain_text.js":174,"./powershell":175,"./powershell.js":175,"./praat":176,"./praat.js":176,"./prolog":177,"./prolog.js":177,"./properties":178,"./properties.js":178,"./protobuf":179,"./protobuf.js":179,"./python":180,"./python.js":180,"./r":181,"./r.js":181,"./razor":182,"./razor.js":182,"./rdoc":183,"./rdoc.js":183,"./red":184,"./red.js":184,"./rhtml":185,"./rhtml.js":185,"./rst":186,"./rst.js":186,"./ruby":187,"./ruby.js":187,"./rust":188,"./rust.js":188,"./sass":189,"./sass.js":189,"./scad":190,"./scad.js":190,"./scala":191,"./scala.js":191,"./scheme":192,"./scheme.js":192,"./scss":193,"./scss.js":193,"./sh":194,"./sh.js":194,"./sjs":195,"./sjs.js":195,"./smarty":196,"./smarty.js":196,"./snippets":197,"./snippets.js":197,"./soy_template":198,"./soy_template.js":198,"./space":199,"./space.js":199,"./sparql":200,"./sparql.js":200,"./sql":201,"./sql.js":201,"./sqlserver":202,"./sqlserver.js":202,"./stylus":203,"./stylus.js":203,"./svg":204,"./svg.js":204,"./swift":205,"./swift.js":205,"./swig":206,"./swig.js":206,"./tcl":207,"./tcl.js":207,"./tex":208,"./tex.js":208,"./text":209,"./text.js":209,"./textile":210,"./textile.js":210,"./toml":211,"./toml.js":211,"./tsx":212,"./tsx.js":212,"./turtle":213,"./turtle.js":213,"./twig":214,"./twig.js":214,"./typescript":215,"./typescript.js":215,"./vala":216,"./vala.js":216,"./vbscript":217,"./vbscript.js":217,"./velocity":218,"./velocity.js":218,"./verilog":219,"./verilog.js":219,"./vhdl":220,"./vhdl.js":220,"./wollok":221,"./wollok.js":221,"./xml":222,"./xml.js":222,"./xquery":223,"./xquery.js":223,"./yaml":224,"./yaml.js":224};function n(e){var t=i(e);return a(t)}function i(e){if(!a.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}n.keys=function(){return Object.keys(r)},n.resolve=i,e.exports=n,n.id=303},306:function(e,t,a){var r={"./ambiance":225,"./ambiance.js":225,"./chaos":226,"./chaos.js":226,"./chrome":227,"./chrome.js":227,"./clouds":228,"./clouds.js":228,"./clouds_midnight":229,"./clouds_midnight.js":229,"./cobalt":230,"./cobalt.js":230,"./crimson_editor":231,"./crimson_editor.js":231,"./dawn":232,"./dawn.js":232,"./dracula":233,"./dracula.js":233,"./dreamweaver":234,"./dreamweaver.js":234,"./eclipse":235,"./eclipse.js":235,"./github":236,"./github.js":236,"./gob":237,"./gob.js":237,"./gruvbox":238,"./gruvbox.js":238,"./idle_fingers":239,"./idle_fingers.js":239,"./iplastic":240,"./iplastic.js":240,"./katzenmilch":241,"./katzenmilch.js":241,"./kr_theme":242,"./kr_theme.js":242,"./kuroir":243,"./kuroir.js":243,"./merbivore":244,"./merbivore.js":244,"./merbivore_soft":245,"./merbivore_soft.js":245,"./mono_industrial":246,"./mono_industrial.js":246,"./monokai":247,"./monokai.js":247,"./pastel_on_dark":248,"./pastel_on_dark.js":248,"./solarized_dark":249,"./solarized_dark.js":249,"./solarized_light":250,"./solarized_light.js":250,"./sqlserver":251,"./sqlserver.js":251,"./terminal":252,"./terminal.js":252,"./textmate":253,"./textmate.js":253,"./tomorrow":254,"./tomorrow.js":254,"./tomorrow_night":255,"./tomorrow_night.js":255,"./tomorrow_night_blue":256,"./tomorrow_night_blue.js":256,"./tomorrow_night_bright":257,"./tomorrow_night_bright.js":257,"./tomorrow_night_eighties":258,"./tomorrow_night_eighties.js":258,"./twilight":259,"./twilight.js":259,"./vibrant_ink":260,"./vibrant_ink.js":260,"./xcode":261,"./xcode.js":261};function n(e){var t=i(e);return a(t)}function i(e){if(!a.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}n.keys=function(){return Object.keys(r)},n.resolve=i,e.exports=n,n.id=306},320:function(e,t,a){"use strict";a.r(t);var r=a(1),n=a.n(r),i=a(52),s=a.n(i),o=a(16),l=a(342),c=a(344),u=a(345),p=a(8),d=a(30),m=d.a.create({main:{padding:"15px 0"}}),h=a(340),f="PUSH_MESSAGES",g="REMOVE_ALL_MESSAGES",b="UPDATE_MESSAGES",y="SAVE_DRAFT",j="SEND_DRAFT_MESSAGE";function v(e){return{type:y,payload:{message:e}}}var E="ADD_CHAT",w="REMOVE_CHAT";var O="CREATE_REWIND_POINT",k="REMOVE_REWIND_POINT",x="SELECT_REWIND_POINT",_="UPDATE_REWIND_POINTS";var S,C=["height","color","weight"],I="name",T="table",D=a(6),M=a(10),P=a(15),N=a(13),R=a(12),q=a(7),F=a(14),A=a(328),V=a(329),$=a(330),B=a(331),U=a(325),z=a(326),W=a(327),H=a(322),L=a(267),G=a(22),J=a.n(G),Y=a(60),Z=a.n(Y),X={showOnGameControlCreateChats:!0,addChatIdToChatFromArray:!0,addChatIdToChatToArray:!0,preFillFrom:!1},K=[{chatId:"red",label:"Red Chat",options:Object(D.a)({},X)},{chatId:"blue",label:"Blue Chat",options:Object(D.a)({},X)},{chatId:"white",label:"White Chat",options:Object(D.a)({},X,{addChatIdToChatToArray:!1,preFillFrom:!0})}],Q=function(){return K.filter(function(e){return e.options.showOnGameControlCreateChats})},ee=K,te=a(323),ae=a(324),re=a(346),ne=function(e){var t=e.createRewindPoint,a=n.a.createRef();return n.a.createElement(H.a,null,n.a.createElement("form",{onSubmit:function(e){e.preventDefault(),a.current.value&&a.current.value.length&&(t(a.current.value),a.current.value="")}},n.a.createElement(te.a,null,n.a.createElement(ae.a,{innerRef:a,placeholder:"New rewind point"}),n.a.createElement(re.a,{addonType:"append"},n.a.createElement(L.a,{color:"warning"},"Create")))))},ie=d.a.create({main:{padding:"15px 0"},hide:{display:"none"},createMessage:{display:"none"},createMessageShow:{display:"block"}}),se=function(e){var t=e.rewinds,a=(e.removeRewindPoint,e.selectRewindPoint);return n.a.createElement(U.a,{className:Object(p.css)(!t.length&&ie.hide)},n.a.createElement("p",null,"Rewind Points:"),n.a.createElement(z.a,null,t.map(function(e,t){var r=e.doc;return n.a.createElement(W.a,{key:t,tag:"button",active:r.active,onClick:function(){a(r._id)}},r.name)})))},oe=Object(o.b)(function(e){return{rewinds:e.rewindPoints.points,active:e.rewindPoints.activeRewind}},function(e){return{removeRewindPoint:function(t){e({type:k,payload:{id:t}})},selectRewindPoint:function(t){e({type:x,payload:{id:t}})}}})(se),le=function(e){function t(e,a){var r;return Object(M.a)(this,t),(r=Object(N.a)(this,Object(R.a)(t).call(this,e,a))).newMessageForm=r.newMessageForm.bind(Object(q.a)(r)),r.closeMessageForm=r.closeMessageForm.bind(Object(q.a)(r)),r.injectForm=r.injectForm.bind(Object(q.a)(r)),r.generateMessages=r.generateMessages.bind(Object(q.a)(r)),r.editor=null,r.editorRef=n.a.createRef(),r.state={activeSchema:null,createChats:Q()},r}return Object(F.a)(t,e),Object(P.a)(t,[{key:"generateMessages",value:function(e){var t=this;this.props.createMessages(Array.apply(null,Array(e)).map(function(){var e=t.props.messageTypes[Math.floor(Math.random()*t.props.messageTypes.length)];return e.required.reduce(function(t,a){t.type=e.scheme;var r="",n=e.properties[a].enum;if(Array.isArray(n)&&n.length)r=n[Math.floor(Math.random()*n.length)];else if("color"===e.properties[a].format)r="#"+Math.floor(16777215*Math.random()).toString(16);else switch(e.properties[a].type){case"integer":r=Math.floor(999*Math.random());break;case"string":r=Z()({count:1});break;default:r=e.properties[a].default||Z()({count:1})}return t[a]=r,t},{})}))}},{key:"newMessageForm",value:function(e){if(this.state.activeSchema!==e.target.name){this.editor&&this.editor.destroy(),this.setState({activeSchema:e.target.name});var t=this.props.messageTypes[e.target.name];t.properties.from.enum=t.properties.from.enum.sort(function(e,t){return"white"===e?-1:"white"===t?1:0}),this.editor=new J.a(this.editorRef.current,{schema:t,theme:"bootstrap4"})}else this.closeMessageForm()}},{key:"closeMessageForm",value:function(){this.editor.destroy(),this.setState({activeSchema:null})}},{key:"injectForm",value:function(){this.editor.validate().length||(this.props.createMessages([Object(D.a)({},this.editor.getValue(),{type:this.editor.schema.scheme})]),this.closeMessageForm())}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:Object(p.css)(ie.main)},n.a.createElement(A.a,{className:"main"},n.a.createElement(V.a,{md:4},n.a.createElement($.a,null,n.a.createElement(B.a,null,"Game Control"),n.a.createElement(U.a,null,n.a.createElement("p",null,"Inject Messages:"),n.a.createElement(z.a,null,this.props.messageTypes.map(function(t,a){return n.a.createElement(W.a,{key:a,tag:"button",active:a===parseInt(e.state.activeSchema),onClick:e.newMessageForm,name:a},t.title)}))),!!this.state.createChats.length&&n.a.createElement(U.a,null,n.a.createElement("p",null,"Create chats:"),n.a.createElement(z.a,null,this.state.createChats.map(function(t,a){var r=e.props.chats.includes(t.chatId);return n.a.createElement(W.a,{key:a,tag:"button",active:r,onClick:function(){r?e.props.removeChat(t.chatId):e.props.createChat(t)}},t.label)}))),n.a.createElement(ne,{createRewindPoint:this.props.createRewindPoint}),n.a.createElement(oe,null),n.a.createElement(H.a,null,n.a.createElement(L.a,{block:!0,color:"success",onClick:function(){e.generateMessages(50)}},"Generate 50 Messages"),n.a.createElement(L.a,{block:!0,color:"success",onClick:function(){e.generateMessages(100)}},"Generate 100 Messages"),n.a.createElement(L.a,{block:!0,color:"success",onClick:function(){e.generateMessages(1e3)}},"Generate 1000 Messages")),n.a.createElement(H.a,null,n.a.createElement(L.a,{block:!0,color:"primary",href:"/export"},"Export Messages")),n.a.createElement(H.a,null,n.a.createElement(L.a,{block:!0,color:"danger",onClick:this.props.clearMessages},"Clear Messages")))),n.a.createElement(V.a,{md:8},n.a.createElement("div",{className:Object(p.css)(ie.createMessage,this.state.activeSchema&&ie.createMessageShow)},n.a.createElement($.a,null,n.a.createElement(U.a,null,n.a.createElement("div",{ref:this.editorRef})),n.a.createElement(H.a,null,n.a.createElement(L.a,{color:"success",onClick:this.injectForm},"Inject")))))))}}]),t}(r.Component),ce=Object(o.b)(function(e){return{messageTypes:e.messageTypes.filter(function(e){return C.includes(e.scheme)}),chats:e.chats.map(function(e){return e&&e.id})}},function(e){return{createMessages:function(t){e(function(e){return{type:f,payload:{messages:e}}}(t))},clearMessages:function(){e({type:g})},createChat:function(t){e(function(e){var t=e.chatId,a=e.label;return{type:E,payload:{chat:{id:t,label:a}}}}(t))},removeChat:function(t){e({type:w,payload:t})},createRewindPoint:function(t){e(function(e,t){return{type:O,payload:{name:e,db:t}}}(t,"messages"))}}})(le),ue=d.a.create({chatItem:{paddingBottom:"15px"}}),pe=p.StyleSheet.create({main:{height:"320px",position:"relative",paddingTop:"0.1px",":after":{content:'""',display:"block",position:"absolute",width:"100%",height:"20px",top:"100%",background:"linear-gradient(to bottom, rgba(255,255,255,0) 0%,rgba(255,255,255,1) 100%)",left:"0"},":before":{content:'""',display:"block",position:"absolute",width:"100%",height:"20px",bottom:"100%",left:"0",zIndex:"2",background:"linear-gradient(to bottom, rgba(255,255,255,1) 0%,rgba(255,255,255,0) 100%)"}},container:{position:"absolute",maxHeight:"100%",height:"auto",left:"0",bottom:"0",width:"100%"},item:{display:"inline-block",verticalAligin:"top",maxWidth:"100%"},scrolContent:{padding:"20px"},badge:{maxWidth:"100%",fontSize:"16px",lineHeight:"20px",padding:"5px 15px",borderRadius:"15px 0 15px 15px",position:"relative",overflow:"hidden",display:"inline-block",verticalAligin:"top",opacity:"0.9",color:"#fff",":hover":{opacity:"1"}},badgeLeft:{borderRadius:"0 15px 15px 15px"},badgeBg:{opacity:"0.8",position:"absolute",left:"0",bottom:"0",height:"100%",width:"100%"},message:{position:"relative"},scrollbar:{boxSizing:"content-box",width:"100%",padding:"20px",margin:"-20px 0 0 -20px",position:"relative",height:"100%"}}),de=a(269),me=a.n(de),he={blue:"bg-primary",gray:"bg-secondary",green:"bg-success",red:"bg-danger",yellow:"bg-warning",black:"bg-dark",white:"bg-white",lightBlue:"bg-info",lightGray:"bg-light",lightBlack:"bg-muted"},fe={transparent:"link",blue:"primary",gray:"secondary",green:"success",red:"danger",yellow:"warning",lightBlue:"info"},ge={blue:"text-primary",gray:"text-secondary",green:"text-success",red:"text-danger",yellow:"text-warning",black:"text-dark",white:"text-white",lightBlue:"text-info",lightGray:"text-light",lightBlack:"text-muted"},be=function(){function e(t){Object(M.a)(this,e),this.itemId=t,this.items={},this.itemDefault={},this.global={}}return Object(P.a)(e,[{key:"getGlobalScheme",value:function(){return this.global}},{key:"getItemScheme",value:function(){return Object(D.a)({},this.itemDefault,this.items[this.itemId]||{})}},{key:"getScheme",value:function(){return{item:this.getItemScheme(),global:this.getGlobalScheme()}}}]),e}(),ye=function(e){function t(e){var a;return Object(M.a)(this,t),(a=Object(N.a)(this,Object(R.a)(t).call(this,e))).items={red:{bg:he.red},blue:{bg:he.blue}},a.itemDefault={bg:he.gray,text:ge.white},a}return Object(F.a)(t,e),t}(be),je=a(61),ve=a.n(je),Ee=function(e){function t(e,a){var n;return Object(M.a)(this,t),(n=Object(N.a)(this,Object(R.a)(t).call(this,e,a))).timeId=null,n.loadTimeId=null,n.loading=!1,n.scrolledDown=!0,n.scrollbar=Object(r.createRef)(),n.loadMoreCount=10,n.getScrollHeight=n.getScrollHeight.bind(Object(q.a)(n)),n.onScrollUp=n.onScrollUp.bind(Object(q.a)(n)),n.onYReachStart=n.onYReachStart.bind(Object(q.a)(n)),n.onYReachEnd=n.onYReachEnd.bind(Object(q.a)(n)),n.scrollToDown=n.scrollToDown.bind(Object(q.a)(n)),n.firstScrolled=!1,n.state={showItemsCount:10},n}return Object(F.a)(t,e),Object(P.a)(t,[{key:"componentWillUnmount",value:function(){clearTimeout(this.loadTimeId)}},{key:"onScrollUp",value:function(){this.scrolledDown=!1}},{key:"onYReachEnd",value:function(){this.scrolledDown=!0}},{key:"onYReachStart",value:function(){var e=this;this.loadTimeId&&clearTimeout(this.loadTimeId),this.loadTimeId=setTimeout(function(){var t=e.getScrollHeight();e.scrolledDown||e.loading||(e.loading=!0,e.setState({showItemsCount:e.state.showItemsCount+e.loadMoreCount}),setTimeout(function(){e.scrollbar.current&&(e.scrollbar.current._container.scrollTop=e.getScrollHeight()-t),e.loading=!1}))})}},{key:"getScrollHeight",value:function(){return this.scrollbar.current?this.scrollbar.current._container.scrollHeight:0}},{key:"scrollToDown",value:function(){var e=this;this.timeId&&clearTimeout(this.timeId),this.timeId=setTimeout(function(){e.scrollbar.current?(e.scrollbar.current._container.scrollTop=e.getScrollHeight(),e.firstScrolled=!0):e.firstScrolled||(e.timeId=setTimeout(function(){e.scrollToDown()},512))})}},{key:"componentWillReceiveProps",value:function(e){if(0!==this.props.messages.length&&e.messages.length>this.state.showItemsCount&&this.props.messages.length<e.messages.length){var t=e.messages.length-this.props.messages.length;this.setState({showItemsCount:this.state.showItemsCount+(t>this.loadMoreCount?this.loadMoreCount:t)})}this.scrollToDown()}},{key:"renderItem",value:function(e){if(!e)return"";var t=e.from===this.props.chatId,a=new ye(e.from).getItemScheme(),r={};return t&&(r={textAlign:"right"}),n.a.createElement("div",{style:r},n.a.createElement("div",{className:Object(p.css)(pe.item)},n.a.createElement("div",{className:Object(p.css)(pe.badge,!t&&pe.badgeLeft)},n.a.createElement("div",{className:ve()(Object(p.css)(pe.badgeBg),a.bg)}),n.a.createElement("div",{className:ve()(Object(p.css)(pe.message),a.text)},Object.keys(e).map(function(t){return"_"!==t.charAt(0)&&e[t]&&n.a.createElement("div",{key:t},n.a.createElement("strong",null,t,":")," ",e[t])})))))}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:Object(p.css)(pe.main)},n.a.createElement("div",{className:Object(p.css)(pe.scrollbar)},n.a.createElement(me.a,{ref:this.scrollbar,onYReachEnd:this.onYReachEnd,onScrollUp:this.onScrollUp,onYReachStart:this.onYReachStart,suppressScrollX:!0,className:Object(p.css)(pe.container),contentClassName:Object(p.css)(pe.scrolContent)},n.a.createElement("div",{className:Object(p.css)(pe.scrolContent)},this.props.messages.slice(Math.max(this.props.messages.length-this.state.showItemsCount,0)).map(function(t,a){return n.a.createElement("div",{key:a},e.renderItem(t.doc))})))))}}]),t}(r.Component),we=Object(o.b)(function(e,t){var a=t.chatId;return{messages:e.messages&&Array.isArray(e.messages[a])?e.messages[a]:[],chatId:a}},function(e){return{}})(Ee),Oe=a(5),ke=a.n(Oe),xe=function(e){function t(e){var a;return Object(M.a)(this,t),(a=Object(N.a)(this,Object(R.a)(t).call(this,e))).items={red:{bg:he.red,text:ge.white},blue:{bg:he.blue,text:ge.white}},a.itemDefault={bg:he.lightGray,text:ge.black,btn:fe.gray},a.global={body:he.white,footer:he.light,tab:he.white,activeTab:ke()(he.blue,ge.white)},a}return Object(F.a)(t,e),t}(be),_e=a(54),Se=a(270);try{S=a(301)}catch(ya){S={}}S=Object(D.a)({},Se,S);var Ce=Object(D.a)({},S),Ie=function(e,t,a){if(!S[e]&&!a)return new _e.a(e);a||(a={});var r=S[e]?Object(D.a)({},S[e],a):a,n=new _e.a(r.name||e);if(r.remote&&t){var i=new _e.a(r.remote);n.replicate.to(i,{live:r.live,retry:r.retry}).on("complete",function(e){console.log("complete",e)}),n.replicate.from(i,{live:r.live,retry:r.retry}).on("complete",function(e){console.log("complete from",e)})}return n},Te={};ee.forEach(function(e){var t=e.chatId;Te[t]={map:'function (doc) { if(doc.to === "'.concat(t,'" && doc.draft === false || doc.from === "').concat(t,'") emit(doc.id); }')}});var De={messages:Te},Me=function e(t,a,r){var n=a.split("/")[0];return t.query(a,r).catch(function(i){if(!De[n])throw new Error("View "+n+" is not defined.");if(404===i.status)return t.put({_id:"_design/"+n,views:De[n]}).then(function(){return e(t,a,r)})})},Pe={cloneFilter:"function (doc) { return !doc._deleted; }"};ee.forEach(function(e){var t=e.chatId;Pe[t]='function (doc) { return doc.to === "'.concat(t,'" && doc.draft === false || doc.from === "').concat(t,'"; }')});var Ne={messages:Pe},Re="filter",qe=p.StyleSheet.create({label:{position:"absolute",top:0,right:0},labelContainer:{position:"relative",width:"100%"},labelButton:{paddingRight:"0 !important",paddingLeft:"0 !important"}}),Fe=function(e){var t=e.colorScheme,a=e.button,r=e.children,i=e.chatId,s=e.defaultMessageType,o=e.createDraft;return n.a.createElement(B.a,{className:t.item.bg},n.a.createElement("div",{className:Object(p.css)(qe.labelContainer)},n.a.createElement("div",{className:Object(p.css)(qe.label)},n.a.createElement(L.a,{color:"link",className:Object(p.css)(qe.labelButton)},n.a.createElement("strong",{className:t.item.text},r)))),a&&s&&n.a.createElement(L.a,{color:t.item.btn,onClick:function(){var e={};s.required.forEach(function(t){var a="",r=s.properties[t].enum;Array.isArray(r)&&r.length?a="from"===t&&r.includes(i)?i:s.properties[t].default?s.properties[t].default:r[0]:s.properties[t].default&&(a=s.properties[t].default),e[t]=a}),o(e)}},a))};Fe.defaultValues={button:"",children:""};var Ae=Fe,Ve=Object(o.b)(function(e){return{defaultMessageType:e.messageTypes.find(function(e){return e.scheme===I})}},function(e){return{createDraft:function(t){e(v(t))}}})(Ae),$e=a(332),Be=a(333),Ue=a(343),ze=a(334),We=a(335),He=a(336),Le=a(337),Ge=a(338),Je=a(339),Ye=a(35),Ze=a(29),Xe=function(e){function t(e,a){var r;return Object(M.a)(this,t),(r=Object(N.a)(this,Object(R.a)(t).call(this,e,a))).initForm=r.initForm.bind(Object(q.a)(r)),r.submitForm=r.submitForm.bind(Object(q.a)(r)),r.getFormFilteredData=r.getFormFilteredData.bind(Object(q.a)(r)),r.editor=null,r.editorBox=n.a.createRef(),r.hiddenAutofillKeys=["draft","_id","_rev","from","test"],r}return Object(F.a)(t,e),Object(P.a)(t,[{key:"componentDidMount",value:function(){this.initForm()}},{key:"componentWillReceiveProps",value:function(e){this.editor&&this.editor.setValue(this.getFormFilteredData(e.form,e.message).values)}},{key:"getFormFilteredData",value:function(e,t){var a=Object(D.a)({},e,{required:["_id"].concat(Object(Ze.a)(e.required)),properties:Object(D.a)({},e.properties)}),r=Object(D.a)({},t);return this.hiddenAutofillKeys.forEach(function(e){var t=a.required.indexOf(e);t>-1&&a.required.splice(t,1),a.properties[e]&&delete a.properties[e],r[e]&&delete r[e]}),{form:a,values:r}}},{key:"initForm",value:function(){var e=this,t=this.getFormFilteredData(this.props.form,this.props.message);this.editor=new J.a(this.editorBox.current,{schema:t.form,theme:"bootstrap4"}).setValue(t.values);var a=function(t){e.editor.editors.hasOwnProperty(t)&&"root"!==t&&e.editor.watch(t,function(a){e.props.saveDraft(Object(D.a)({},e.props.message,e.editor.getValue(),Object(Ye.a)({},t.replace("root.",""),e.editor.getEditor(t).getValue())))})};for(var r in this.editor.editors)a(r)}},{key:"submitForm",value:function(){this.editor.validate().length||this.props.sendDraftMessage(Object(D.a)({type:this.editor.schema.scheme},this.props.message,this.editor.getValue()))}},{key:"render",value:function(){return n.a.createElement("div",{className:"messageEdit"},n.a.createElement("div",{ref:this.editorBox}),n.a.createElement(L.a,{onClick:this.submitForm},this.props.button))}}]),t}(r.Component),Ke=function(e){function t(e,a){var r;return Object(M.a)(this,t),(r=Object(N.a)(this,Object(R.a)(t).call(this,e,a))).renderDropdown=r.renderDropdown.bind(Object(q.a)(r)),r.toggle=r.toggle.bind(Object(q.a)(r)),r.toggleDropdown=r.toggleDropdown.bind(Object(q.a)(r)),r.renderTabs=r.renderTabs.bind(Object(q.a)(r)),r.showDropdownAfter=3,r.state={activeDraft:e.messages.length-1,dropdownOpen:!1},r}return Object(F.a)(t,e),Object(P.a)(t,[{key:"componentWillReceiveProps",value:function(e){this.props.messages.length!==e.messages.length&&this.toggle(e.messages.length-1)}},{key:"toggle",value:function(e){this.setState({activeDraft:e})}},{key:"toggleDropdown",value:function(){this.setState({dropdownOpen:!this.state.dropdownOpen})}},{key:"renderDropdown",value:function(){var e=this;return n.a.createElement($e.a,{isOpen:this.state.dropdownOpen,toggle:this.toggleDropdown},n.a.createElement(Be.a,{caret:!0,className:this.props.colorScheme.global.activeTab},this.props.messages[this.state.activeDraft].doc.title||"Draft ".concat(this.state.activeDraft)),n.a.createElement(Ue.a,{right:!0},this.props.messages.map(function(t,a){return n.a.createElement(ze.a,{key:a,className:e.state.activeDraft===a?e.props.colorScheme.global.activeTab:"",onClick:function(){e.toggle(a)}},t.doc.title||"Draft ".concat(a))})))}},{key:"renderTabs",value:function(){var e=this;return this.props.messages.length<2?n.a.createElement("div",null):n.a.createElement(We.a,{tabs:!0},this.props.messages.map(function(t,a){return n.a.createElement(He.a,{key:a},n.a.createElement(Le.a,{className:e.state.activeDraft===a?e.props.colorScheme.global.activeTab:e.props.colorScheme.global.tab,onClick:function(){e.toggle(a)}},t.doc.title?t.doc.title:"Draft ".concat(a+1)))}))}},{key:"render",value:function(){var e=this;return n.a.createElement(H.a,{className:this.props.colorScheme.global.footer},this.props.messages.length>0&&n.a.createElement(Ge.a,{activeTab:this.state.activeDraft+""},this.props.messages.length>this.showDropdownAfter?this.renderDropdown():this.renderTabs(),this.props.messages.map(function(t,a){return n.a.createElement(Je.a,{key:a,tabId:a+""},n.a.createElement(Xe,{message:t.doc,button:e.props.button,form:e.props.form,saveDraft:e.props.saveDraft,sendDraftMessage:e.props.sendDraftMessage}))})))}}]),t}(r.Component),Qe=Object(o.b)(function(e,t){var a=t.chatId;return{messages:e.messages&&Array.isArray(e.messages[a])?e.messages[a].filter(function(e){return e.doc.draft}):[],form:Object(D.a)({},e.messageTypes.find(function(e){return e.scheme===I}),{format:T})}},function(e){return{sendDraftMessage:function(t){e({type:j,payload:{message:t}})},saveDraft:function(t){e(v(t))}}})(Ke),et=function(e){function t(e,a){var r;return Object(M.a)(this,t),(r=Object(N.a)(this,Object(R.a)(t).call(this,e,a))).updateState=function(e){r.changeTimer&&clearTimeout(r.changeTimer),r.changeTimer=setTimeout(function(){console.log(r.db),Me(r.db,"messages/"+r.props.chatId,{include_docs:!0,filter:Re+"messages/"+r.props.chatId}).then(function(t){var a=t.rows;console.log(a),r.props.updateMessages(a||[],r.props.chatId),"function"===typeof e&&e()})},r.changeTime)},r.changeTimer=null,r.changeTime=128,r.updateState=r.updateState.bind(Object(q.a)(r)),r.initDatabase=r.initDatabase.bind(Object(q.a)(r)),r.dbName="messages",r.db=null,r.changes=null,r.state={colorScheme:new xe(e.chatId).getScheme()},r}return Object(F.a)(t,e),Object(P.a)(t,[{key:"componentWillMount",value:function(){this.initDatabase(this.props.chatId,this.props.activeRewind)}},{key:"componentWillReceiveProps",value:function(e){this.initDatabase(e.chatId,e.activeRewind)}},{key:"initDatabase",value:function(e,t){var a,r,n=this,i=t&&t.doc.local!==this.dbName,s=!this.db;(this.props.chatId!==e||i||s||this.props.activeRewind&&!t)&&(this.changes&&this.changes.cancel(),i?(this.dbName=t.doc.local,this.db=Ie(this.dbName,!1,Object(D.a)({},Ce.messages,{name:t.doc.local,remote:Ce.messages.remote?Ce.messages.remote.replace("messages",this.dbName):null})),s=!0):(s||"messages"!==this.dbName)&&(s=!0,this.dbName="messages",this.db=Ie(this.dbName)),s&&this.updateState(),this.changes=(a=this.db,r="messages/"+e,a.changes({since:"now",live:!0,include_docs:!0,filter:Re+r})).on("change",function(){n.updateState()}),this.setState({colorScheme:new xe(e).getScheme()}))}},{key:"componentWillUnmount",value:function(){this.changes.cancel(),clearTimeout(this.changeTimer)}},{key:"render",value:function(){return n.a.createElement($.a,null,n.a.createElement(Ve,{colorScheme:this.state.colorScheme,button:"Add >>",chatId:this.props.chatId},this.props.label),n.a.createElement(U.a,{className:this.state.colorScheme.global.body},n.a.createElement(we,{chatId:this.props.chatId})),n.a.createElement(Qe,{colorScheme:this.state.colorScheme,button:"Send",chatId:this.props.chatId}))}}]),t}(r.Component),tt=Object(o.b)(function(e){return{activeRewind:e.rewindPoints.points.filter(function(e){return e.doc.active})[0]}},function(e){return{updateMessages:function(t,a){e(function(e,t){return{type:b,payload:{messages:e,chatId:t}}}(t,a))}}})(et),at=12,rt=6,nt=4,it=function(e){var t=e.chats,a=e.form;return n.a.createElement(A.a,null,t.map(function(e,t){return e&&n.a.createElement(V.a,{xs:at,sm:rt,md:nt,key:t},n.a.createElement("div",{className:Object(p.css)(ue.chatItem)},n.a.createElement(tt,{chatId:e.id,label:e.label,form:a})))}))},st=Object(o.b)(function(e){return{chats:e.chats,form:Object(D.a)({},e.messageTypes.find(function(e){return e.scheme===I}),{format:T})}},function(e){return{}})(it),ot=function(){return n.a.createElement(h.a,{fluid:!0},n.a.createElement("div",{className:Object(p.css)(m.main)},n.a.createElement(st,null),n.a.createElement(ce,null)))},lt="CREATE_EXPORT",ct="REMOVE_EXPORTS";var ut=d.a.create({main:{padding:"15px 0"},title:{fontWeight:"bold",display:"inline-block",lineHeight:"30px"},pageTitle:{marginBottom:"30px"},item:{width:"100%",marginBottom:"15px"}}),pt=a(341),dt=a(272),mt=a.n(dt),ht=function(e){var t=e.exp,a=e.index,r={xlsx:"export_button_".concat(a,"_xlsx"),xls:"export_button_".concat(a,"_xls"),csv:"export_button_".concat(a,"_csv")},i=function(e){return mt.a.convert({anchor:r[e],filename:t.name,format:e},t.data.map(function(e){var t=[];return e.data.length&&(t=Object.keys(e.data[0].doc)),{name:e.title,from:{arrayHasHeader:!0,array:[t.map(function(e){return e.charAt(0).toUpperCase()+e.slice(1)})].concat(Object(Ze.a)(e.data.map(function(e){var a=e.doc;return t.map(function(e){return a[e]})})))}}}))};return n.a.createElement(pt.a,null,n.a.createElement(L.a,{href:"#",size:"sm",color:"success",onClick:function(e){return i("xlsx")},id:r.xlsx},"Download .xlsx"),n.a.createElement(L.a,{href:"#",size:"sm",color:"success",onClick:function(e){return i("xls")},id:r.xls},"Download .xls"))},ft=function(e){var t=e.messageTypes,a=(e.chats,e.exportItems),r=e.createExport,i=e.removeExports;return n.a.createElement(h.a,{fluid:!0},n.a.createElement("div",{className:Object(p.css)(ut.main)},n.a.createElement("h3",{className:Object(p.css)(ut.pageTitle)},"Exports:",n.a.createElement("div",{className:"float-right"},n.a.createElement(pt.a,null,n.a.createElement(L.a,{color:"primary",onClick:function(){r(t)}},"Create Export"),n.a.createElement(L.a,{color:"danger",onClick:i},"Clear Export History")))),a.map(function(e,t){return n.a.createElement("div",{className:Object(p.css)(ut.item),key:t},n.a.createElement($.a,null,n.a.createElement(B.a,null,n.a.createElement("div",{className:Object(p.css)(ut.title)},e.name),n.a.createElement("div",{className:"float-right"},n.a.createElement(ht,{exp:e,index:t})))))})))},gt=Object(o.b)(function(e){return{messageTypes:e.messageTypes,chats:e.chats.map(function(e){return e&&e.id}),exportItems:e.exportItems}},function(e){return{createExport:function(t){e(function(e){return{type:lt,payload:{messageTypes:e}}}(t))},removeExports:function(){e({type:ct,payload:{}})}}})(ft),bt=d.a.create({main:{padding:"15px 0"},devSection:{paddingTop:"15px"}}),yt=a(273);function jt(e){this.jsonEditor=null,this.renderZone="string"===typeof e?document.getElementById(e):e.current}function vt(e){jt.call(this,e)}function Et(e){jt.call(this,e);var t=function(e){if(e.matches('div[data-schemapath$=".properties"] > h3 > div > button.json-editor-btntype-properties')){var t=e.parentElement.parentElement.parentElement.querySelector("h3 > span");if(t&&"properties"===t.innerText)return!0}return!1};this.observer=new MutationObserver(function(e,a){var r=!0,n=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){s.value.addedNodes.forEach(function(e){if(1==e.nodeType)if(t(e))e.querySelector("span").innerText="Add/Remove";else if(e.matches("button.json-editor-btntype-properties")){var a=e.querySelector("i");a.classList.remove("fa-pen"),a.classList.add("fa-cog"),e.querySelector("span").innerText=""}})}}catch(l){n=!0,i=l}finally{try{r||null==o.return||o.return()}finally{if(n)throw i}}}),this.observer.observe(this.renderZone,{childList:!0,subtree:!0})}jt.prototype.destroy=function(){this.jsonEditor&&(this.jsonEditor.destroy(),this.jsonEditor=null)},jt.prototype.updateSchema=function(e){this.destroy(),this.jsonEditor=new J.a(this.renderZone,{schema:e})},jt.prototype.validate=function(){return this.jsonEditor.validate()},jt.prototype.getJSON=function(){return this.jsonEditor.getValue()},vt.prototype=Object.create(jt.prototype),Object.defineProperty(vt.prototype,"constructor",{value:vt,enumerable:!1,writable:!0}),vt.prototype.updateSchema=function(e){this.destroy(),this.jsonEditor=new J.a(this.renderZone,{schema:e,no_additional_properties:!0})},Et.prototype=Object.create(jt.prototype),Object.defineProperty(Et.prototype,"constructor",{value:Et,enumerable:!1,writable:!0}),Et.prototype.updateSchema=function(e){this.destroy();this.jsonEditor=new J.a(this.renderZone,{schema:e,custom_validators:[function(e,t,a){var r=[];return"integer"===t.type&&"range"===t.format&&("undefined"!==typeof t.minimum&&"undefined"!==typeof t.maximum||r.push({path:a,property:"format",message:"The range format requires that you specify both minimum and maximum properties, too."})),r},function(e,t,a){var r=[];return"integer"!==t.type&&"number"!==t.type||"undefined"!==typeof t.minimum&&"undefined"!==typeof t.minimum&&t.minimum>t.maximum&&r.push({path:a,property:"maximum",message:"The maximum value must be greater than or equal than the minimum value."}),r}]});this.jsonEditor.on("ready",function(){var e=this.root.getButton("Save","save","Save"),t=this.root.theme.getHeaderButtonHolder();t.appendChild(e),this.root.header.parentNode.insertBefore(t,this.root.header.nextSibling);var a=this;e.addEventListener("click",function(e){e.preventDefault();var t=a.getValue(),r=new Blob([JSON.stringify(t,null,2)],{type:"application/json;charset=utf-8"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(r,"schema.json");else{var n=document.createElement("a");n.download="schema.json",n.href=URL.createObjectURL(r),n.dataset.downloadurl=["text/plain",n.download,n.href].join(":"),n.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1}))}},!1)})};var wt=function(e){function t(e,a){var r;return Object(M.a)(this,t),(r=Object(N.a)(this,Object(R.a)(t).call(this,e,a))).schemaEditor=null,r.editorBox=n.a.createRef(),r.onChange=r.onChange.bind(Object(q.a)(r)),r.updateEditor=r.updateEditor.bind(Object(q.a)(r)),r.saved="",r.value=r.props.defaultValue,r}return Object(F.a)(t,e),Object(P.a)(t,[{key:"onChange",value:function(e,t){this.schemaEditor.validate().length?alert("Invalid schema"):this.props.onChange&&(this.value=this.schemaEditor.jsonEditor.getValue(),this.props.onChange(this.schemaEditor.getJSON()))}},{key:"componentDidMount",value:function(){this.schemaEditor=new Et("schema-editor"),this.updateEditor(this.props.schema,this.props.options,this.props.defaultValue)}},{key:"componentWillReceiveProps",value:function(e){var t=e.schema,a=e.options;this.updateEditor(t,a)}},{key:"updateEditor",value:function(e,t,a){try{var r=JSON.stringify(e);r===this.save&&t.counter===this.props.options.counter||(J.a.defaults.options.object_layout=t.layout,J.a.defaults.options=Object(D.a)({},J.a.defaults.options,t.booleanOptions),this.save=r,this.schemaEditor.updateSchema(e),this.schemaEditor.jsonEditor.setValue(this.value),this.schemaEditor.jsonEditor.on("change",this.onChange))}catch(n){alert("Invalid json schema"),console.log(n)}}},{key:"render",value:function(){return n.a.createElement($.a,null,n.a.createElement(B.a,null,"Schema Editor"),n.a.createElement(U.a,null,n.a.createElement("div",{id:"schema-editor"})),n.a.createElement(H.a,null))}}]),t}(r.Component),Ot=function(e){function t(e,a){var r;return Object(M.a)(this,t),(r=Object(N.a)(this,Object(R.a)(t).call(this,e,a))).previewBox=n.a.createRef(),r.editorPreview=null,r}return Object(F.a)(t,e),Object(P.a)(t,[{key:"componentDidMount",value:function(){this.editorPreview=new vt("editor-preview")}},{key:"componentWillReceiveProps",value:function(e){var t=e.schema;this.editorPreview.destroy(),this.editorPreview.updateSchema(t)}},{key:"render",value:function(){return n.a.createElement($.a,null,n.a.createElement(B.a,null,"Editor Preview"),n.a.createElement(U.a,null,n.a.createElement("div",{id:"editor-preview",ref:this.previewBox})),n.a.createElement(H.a,null,"The Editor Preview will be updated as you make changes in the Schema Editor"))}}]),t}(r.Component),kt=a(274),xt=a.n(kt),_t=function(e){function t(e,a){var r;return Object(M.a)(this,t),(r=Object(N.a)(this,Object(R.a)(t).call(this,e,a))).editorBox=n.a.createRef(),r.onChange=r.onChange.bind(Object(q.a)(r)),r.setEditorValue=r.setEditorValue.bind(Object(q.a)(r)),r.onUpdateClick=r.onUpdateClick.bind(Object(q.a)(r)),r.saveJson="",r.state={},r}return Object(F.a)(t,e),Object(P.a)(t,[{key:"onChange",value:function(e,t){}},{key:"componentDidMount",value:function(){this.setEditorValue(JSON.stringify(this.props.value,null,2))}},{key:"componentWillRecivedProps",value:function(e){var t=e.value;this.setEditorValue(JSON.stringify(t,null,2))}},{key:"setEditorValue",value:function(e){this.editorBox.current&&this.saveJson!==e&&(this.saveJson=e,this.editorBox.current.editor.setValue(this.saveJson),this.editorBox.current.editor.session.getSelection().clearSelection(),this.editorBox.current.editor.resize())}},{key:"onUpdateClick",value:function(){this.props.onSchemaSubmit(this.editorBox.current.editor.getValue())}},{key:"render",value:function(){return n.a.createElement($.a,null,n.a.createElement(B.a,null,"Meta Schema"),n.a.createElement(U.a,{style:{padding:0}},n.a.createElement(xt.a,{mode:"json",theme:"monokai",setReadOnly:!1,onChange:this.onChange,style:{height:"400px"},ref:this.editorBox})),n.a.createElement(H.a,null,n.a.createElement(L.a,{onClick:this.onUpdateClick},"Update Schema Editor")))}}]),t}(r.Component),St=[{value:"required_by_default",label:"Object properties required by default",selected:!1},{value:"display_required_only",label:"Only show required properties by default",selected:!1},{value:"no_additional_properties",label:"No additional object properties",selected:!1},{value:"ajax",label:"Allow loading schemas via Ajax",selected:!1},{value:"disable_edit_json",label:'Disable "Edit JSON" buttons'},{value:"disable_collapse",label:"Disable collapse buttons",selected:!1},{value:"disable_properties",label:"Disable properties buttons",selected:!1},{value:"disable_array_add",label:"Disable array add buttons",selected:!1},{value:"disable_array_reorder",label:"Disable array move buttons",selected:!1},{value:"disable_array_delete",label:"Disable array delete buttons",selected:!1},{value:"enable_array_copy",label:"Add copy buttons to arrays",selected:!1},{value:"array_controls_top",label:"Array controls will be displayed at top of list",selected:!1},{value:"disable_array_delete_all_rows",label:"Disable array delete all rows buttons",selected:!1},{value:"disable_array_delete_last_row",label:"Disable array delete last row buttons",selected:!1}],Ct=function(e){function t(e,a){var r;return Object(M.a)(this,t),(r=Object(N.a)(this,Object(R.a)(t).call(this,e,a))).onBooleanOptionsChange=r.onBooleanOptionsChange.bind(Object(q.a)(r)),r.onLayoutChange=r.onLayoutChange.bind(Object(q.a)(r)),r}return Object(F.a)(t,e),Object(P.a)(t,[{key:"onBooleanOptionsChange",value:function(e){for(var t=e.target.options,a={},r=0,n=t.length;r<n;r++)a[t[r].value]=t[r].selected;this.props.onChange(Object(D.a)({},this.props,{booleanOptions:a,counter:(this.props.options.counter||0)+1}))}},{key:"onLayoutChange",value:function(e){this.props.onChange(Object(D.a)({},this.props.options,{layout:e.target.value,counter:(this.props.options.counter||0)+1}))}},{key:"render",value:function(){return n.a.createElement($.a,null,n.a.createElement(B.a,null,"Boolean options"),n.a.createElement(U.a,null,n.a.createElement(ae.a,{type:"select",multiple:!0,size:"11",defaultValue:[],onChange:this.onBooleanOptionsChange},St.map(function(e,t){return n.a.createElement("option",{key:t,value:e.value},e.label)}))),n.a.createElement(H.a,null,n.a.createElement(te.a,null,n.a.createElement(re.a,{addonType:"prepend"},"Object layout:"),n.a.createElement(ae.a,{type:"select",value:this.props.options.layout,onChange:this.onLayoutChange},n.a.createElement("option",{value:"normal"},"normal"),n.a.createElement("option",{value:"grid"},"grid")))))}}]),t}(r.Component),It=function(e){e.children;return n.a.createElement("div",null,!1)},Tt=function(e){function t(e,a){var r;return Object(M.a)(this,t),r=Object(N.a)(this,Object(R.a)(t).call(this,e,a)),J.a.defaults.options.iconlib="fontawesome5",J.a.defaults.options.theme="bootstrap4",r.updateMetaSchema=r.updateMetaSchema.bind(Object(q.a)(r)),r.updatePreviewSchema=r.updatePreviewSchema.bind(Object(q.a)(r)),r.updateOptions=r.updateOptions.bind(Object(q.a)(r)),r.schemaEditor=null,r.editorPreview=null,r.defaultValue={type:"object",properties:{Date:{type:"string",format:"datetime-local"},Status:{type:"string",enum:["Minor","Major","Critical"]},Description:{type:"string",format:"textarea"}},title:"Machinery Failure",format:"grid"},r.state={metaSchema:yt,previewSchema:null,options:{layout:J.a.defaults.options.object_layout,booleanOptions:{}}},r}return Object(F.a)(t,e),Object(P.a)(t,[{key:"updatePreviewSchema",value:function(e){console.log("preview update"),this.setState({previewSchema:e})}},{key:"updateOptions",value:function(e){console.log("options update"),this.setState({options:e})}},{key:"updateMetaSchema",value:function(e){console.log("editor update"),this.setState({metaschema:e})}},{key:"render",value:function(){return n.a.createElement("div",{className:Object(p.css)(bt.main)},n.a.createElement(h.a,{fluid:!0},n.a.createElement(A.a,null,n.a.createElement(V.a,{md:6},n.a.createElement(wt,{schema:this.state.metaSchema,onChange:this.updatePreviewSchema,options:this.state.options,defaultValue:this.defaultValue})),n.a.createElement(V.a,{md:6},n.a.createElement(Ot,{schema:this.state.previewSchema}))),n.a.createElement(It,null,n.a.createElement("div",{className:Object(p.css)(bt.devSection)},n.a.createElement(A.a,null,n.a.createElement(V.a,{md:6},n.a.createElement(Ct,{options:this.state.options,onChange:this.updateOptions})),n.a.createElement(V.a,{md:6},n.a.createElement(_t,{value:this.state.metaSchema,onSchemaSubmit:this.updateMetaSchema})))))))}}]),t}(r.Component),Dt=function(e){function t(e,a){var r;return Object(M.a)(this,t),(r=Object(N.a)(this,Object(R.a)(t).call(this,e,a))).check=r.check.bind(Object(q.a)(r)),r.messagesFiltersInitialized=!1,r.messagesViewsInitialized=!1,r.state={done:!1},r}return Object(F.a)(t,e),Object(P.a)(t,[{key:"check",value:function(){this.messagesFiltersInitialized&&this.messagesViewsInitialized&&this.setState({done:!0})}},{key:"componentWillMount",value:function(){this.checkMessages()}},{key:"checkMessages",value:function(){this.checkFilter(Ne,Re,Object.keys(Ne)),this.checkView(De,Object.keys(De))}},{key:"checkFilter",value:function(e,t,a,r){var n=this;if(r||(r=0),!a.length||a.length<=r)return this.messagesFiltersInitialized=!0,this.check(),!1;var i=Ie(a[r],!1,{live:!1}),s="_design/"+t+a[r];i.get(s).then(function(o){var l=!0;o.filters?Object.keys(e[a[r]]).forEach(function(t){o.filters[t]&&e[a[r]][t]===o.filters[t]||(l=!1)}):l=!1,l?n.checkFilter(e,t,a,r+1):(console.log("Updateing Filters ".concat(s)),i.put(Object(D.a)({},o,{filters:e[a[r]]})).then(function(){console.log("Updateing Filters ".concat(s," (success)")),n.checkFilter(e,t,a,r+1)}))}).catch(function(o){404===o.status&&(console.log("Creating Filters ".concat(s)),i.put({_id:s,filters:e[a[r]]}).then(function(){console.log("Creating Filters ".concat(s," (success)")),n.checkFilter(e,t,a,r+1)}))})}},{key:"checkView",value:function(e,t,a){var r=this;if(a||(a=0),!t.length||t.length<=a)return this.messagesViewsInitialized=!0,this.check(),!1;var n="_design/"+t[a],i=Ie(t[a],!1,{live:!1});i.get(n).then(function(s){var o=!0;s.views?Object.keys(e[t[a]]).forEach(function(r){s.views[r]&&e[t[a]][r].map===s.views[r].map||(o=!1)}):o=!1,o?r.checkView(e,t,a+1):(console.log("Updateing Views ".concat(n)),i.put(Object(D.a)({},s,{views:e[t[a]]})).then(function(){console.log("Updateing Views ".concat(n," (success)")),r.checkView(e,t,a+1)}))}).catch(function(s){var o=s.status;console.log("test",o),404===o&&(console.log("Creating Views ".concat(n)),i.put({_id:n,views:e[t[a]]}).then(function(){console.log("Views Filters ".concat(n," (success)")),r.checkView(e,t,a+1)}))})}},{key:"render",value:function(){return n.a.createElement("div",null,this.state.done&&this.props.children)}}]),t}(r.Component),Mt=function(e){var t=e.initStore,a=e.children;return t(),n.a.createElement("div",null,a)},Pt=Object(o.b)(function(e){return{}},function(e){return{initStore:function(){e({type:"INIT",payload:{}})}}})(Mt),Nt=function(e){var t=e.store;return n.a.createElement(o.a,{store:t},n.a.createElement(Pt,null,n.a.createElement(Dt,null,n.a.createElement(l.a,null,n.a.createElement(c.a,null,n.a.createElement(u.a,{exact:!0,path:"/",component:ot}),n.a.createElement(u.a,{path:"/export",component:gt}),n.a.createElement(u.a,{path:"/json-schema-editor",component:Tt}))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(308),a(309),a(310),a(311);var Rt=a(31),qt=a(32),Ft=[],At=Ie("chats"),Vt=Object(qt.persistentReducer)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ft,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case E:return[].concat(Object(Ze.a)(e),[t.payload.chat]);case w:return e.filter(function(e){return e.id!==t.payload});default:return e}},{db:At,name:"chats"}),$t={type:"object",format:"grid",required:["from","to","title"],properties:{from:{type:"string",enum:K.filter(function(e){return e.options.addChatIdToChatFromArray}).map(function(e){return e.chatId})},to:{type:"string",enum:K.filter(function(e){return e.options.addChatIdToChatToArray}).map(function(e){return e.chatId})},title:{type:"string",description:"Title for this message"}}},Bt=[{scheme:"height",title:"PersonHeight",properties:{height:{type:"integer",default:12}}},{scheme:"weight",title:"PersonWeight",properties:{weight:{type:"integer",default:12}}},{scheme:"color",title:"PersonColor",properties:{color:{type:"string",format:"color"}}},{scheme:"name",title:"PersonName",properties:{name:{type:"string",format:"string"}}}],Ut=function(){return Bt.map(function(e){return Object(D.a)({},$t,{scheme:e.scheme,title:e.title,properties:Object(D.a)({},$t.properties,e.properties),required:[].concat(Object(Ze.a)($t.required),[e.scheme])})})}(),zt=Ie("message-types"),Wt=Object(qt.persistentReducer)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ut;return(arguments.length>1?arguments[1]:void 0).type,e},{db:zt,name:"message-types"}),Ht=Ie("messages",!0),Lt={},Gt=function(e){return(new Date).toISOString()+"-"+(e||"0")},Jt=function(e){return e.map(function(e,t){return Object(D.a)({},e,{_id:Gt(t),draft:!1})})},Yt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Lt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f:var a=Jt(t.payload.messages);return 1===a.length?Ht.put(a[0]):Ht.bulkDocs(a),e;case g:return Ht.allDocs().then(function(e){return Promise.all(e.rows.map(function(e){return-1===e.id.search("_design")&&Ht.remove(e.id,e.value.rev)}))}),{};case b:return Object(D.a)({},e,Object(Ye.a)({},t.payload.chatId,t.payload.messages));case y:var r=Object(D.a)({},Jt([t.payload.message])[0],{draft:!0});return t.payload.message._id&&(r._id=t.payload.message._id),t.payload.message._rev&&(r._rev=t.payload.message._rev),Ht.put(r),e;case j:return Ht.get(t.payload.message._id).then(function(e){Ht.bulkDocs([Object(D.a)({},Jt([t.payload.message])[0],{_rev:""}),Object(D.a)({},e,{_deleted:!0})])}),e;default:return e}},Zt={points:[],activeRewind:null},Xt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Zt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:return Object(D.a)({},e,{points:t.payload.points});default:return e}},Kt=[],Qt=Ie("exports"),ea=Object(qt.persistentReducer)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case lt:return[].concat(Object(Ze.a)(e),[t.payload]);case ct:return[];default:return e}},{db:Qt,name:"exports"}),ta=Object(Rt.combineReducers)({chats:Vt,messageTypes:Wt,messages:Yt,rewindPoints:Xt,exportItems:ea}),aa=a(276),ra=a(277),na=function(e,t){return new Promise(function(a,r){var n=oa(),i=t.name+"-rewind-"+n,s=Ie(i);s.replicate.from(e,{live:!1,retry:!1,filter:"filtermessages/cloneFilter"}).on("complete",function(e){if(console.log("success",e),t.remote){var r=t.remote+"-rewind-"+n;Ie(r).replicate.from(s,{live:!1,retry:!1}).on("complete",function(e){a({_id:n,local:i,remote:!0})}).on("error",function(e){console.log("Error on remote database sync, created only local db"),console.log(e),a({_id:n,local:i,remote:!1})})}else a({_id:n,local:i,remote:!1})}).on("error",function(e){console.log("Error on local db clone"),console.log(e),r()})})},ia=function(e,t){sa(e,t)},sa=function(e,t){e.allDocs({include_docs:!0}).then(function(e){var a=e.rows;t.dispatch({type:_,payload:{points:a}})})},oa=function(e){return(new Date).toISOString()+"-"+(e||"0")},la=function(e){return Object(D.a)({},e,{active:!1,roomId:""})},ca=function(e,t,a,r,n){switch(a.type){case"INIT":ia(r,e);break;case O:na(n,Ce.messages).then(function(t){r.put(Object(D.a)({},la(a.payload),t)).then(function(t){sa(r,e)})});break;case x:r.allDocs({include_docs:!0}).then(function(t){var n=t.rows.filter(function(e){return e.doc.active||e.doc._id===a.payload.id}).map(function(e){return Object(D.a)({},e.doc,{active:!e.doc.active})});r.bulkDocs(n).then(function(){sa(r,e)})});break;default:return!1}return!0},ua=function e(t,a,r,n,i){t||(t=0),a||(a=[]),r[t]?function(e,t){return e.query(function(e,t){t(e.type)},{key:t,include_docs:!0})}(n,r[t].scheme).then(function(s){var o=s.rows;a.push({title:r[t].title,data:o}),e(t+1,a,r,n,i)}):i(a)},pa=function(e,t,a,r,n){switch(a.type){case lt:ua(null,null,a.payload.messageTypes,n,function(e){t(Object(D.a)({},a,{payload:{name:"Export: ".concat((new Date).toISOString().slice(0,19).replace("T"," ")),data:e}}))});break;default:return!1}return!0},da=Ie("rewind-points"),ma=Ie("messages",!1),ha=function(e){return function(t){return function(a){var r=ca(e,t,a,da,ma),n=pa(e,t,a,da,ma);r||n||t(a)}}},fa=Object(Rt.applyMiddleware)(aa.a,ha);console.log("prod");var ga=Ie("main"),ba=Object(ra.composeWithDevTools)(fa,Object(qt.persistentStore)({db:ga}))(Rt.createStore)(ta);s.a.render(n.a.createElement(Nt,{store:ba}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[278,1,2]]]);
//# sourceMappingURL=main.006c0a47.chunk.js.map