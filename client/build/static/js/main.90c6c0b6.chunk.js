(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{269:function(e){e.exports={main:{name:"main",remote:null,live:!1,retry:!1},messages:{name:"messages",remote:"http://localhost:8080/db/messages",live:!0,retry:!1},"message-types":{name:"message-types",remote:null,live:!1,retry:!1},"rewind-points":{name:"rewind-points",remote:"http://localhost:8080//db/rewind-points",live:!0,retry:!1}}},271:function(e){e.exports={$ref:"#/definitions/object",title:"object type",definitions:{string:{required:["type"],defaultProperties:["type","title"],additionalProperties:!1,title:"string type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"string"},format:{type:"string",enum:["color","date","datetime","datetime-local","email","month","number","range","tel","text","textarea","time","url","week","json","sql","xml","yaml"]},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},title:{type:"string",propertyOrder:1},type:{options:{hidden:!0},type:"string",enum:["string"]},enum:{format:"table",items:{title:"alternative",type:"string"},type:"array"},description:{type:"string"}}},null:{required:["type"],defaultProperties:["type","title"],additionalProperties:!1,title:"null type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"null"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},title:{type:"string",propertyOrder:1},type:{options:{hidden:!0},type:"string",enum:["null"]},description:{type:"string"}}},array:{required:["type"],defaultProperties:["type","items","title"],additionalProperties:!1,title:"array type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"array"},format:{default:"table",type:"string",enum:["array","table","tabs","tabs-top","checkbox","select","categories"]},items:{$ref:"#/definitions/schema"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},title:{type:"string",propertyOrder:1},type:{options:{hidden:!0},type:"string",enum:["array"]},description:{type:"string"}}},schema:{default:{type:"object"},oneOf:[{$ref:"#/definitions/null",title:"null type"},{$ref:"#/definitions/boolean",title:"boolean type"},{$ref:"#/definitions/string",title:"string type"},{$ref:"#/definitions/integer",title:"integer type"},{$ref:"#/definitions/number",title:"number type"},{$ref:"#/definitions/object",title:"object type"},{$ref:"#/definitions/array",title:"array type"}],options:{keep_oneof_values:!1},type:"object"},boolean:{required:["type"],defaultProperties:["type","title"],additionalProperties:!1,title:"boolean type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"boolean"},format:{type:"string",enum:["select","checkbox"]},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},title:{type:"string",propertyOrder:1},type:{options:{hidden:!0},type:"string",enum:["boolean"]},description:{type:"string"}}},object:{required:["type"],defaultProperties:["type","properties","title"],additionalProperties:!1,title:"object type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"object"},format:{type:"string",enum:["grid"]},required:{uniqueItems:!0,format:"table",items:{title:"property",type:"string"},type:"array"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},title:{type:"string",propertyOrder:1},type:{options:{hidden:!0},type:"string",enum:["object"]},description:{type:"string"},properties:{type:"object",patternProperties:{".*":{$ref:"#/definitions/propertySchema"}}}}},number:{required:["type"],defaultProperties:["type","title"],additionalProperties:!1,title:"number type",type:"object",properties:{$ref:{format:"uri",type:"string"},maximum:{type:"number"},default:{type:"number"},minimum:{type:"number"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},title:{type:"string",propertyOrder:1},type:{options:{hidden:!0},type:"string",enum:["number"]},enum:{format:"table",items:{title:"alternative",type:"number"},type:"array"},description:{type:"string"}}},integer:{required:["type"],defaultProperties:["type","title"],additionalProperties:!1,title:"integer type",type:"object",properties:{$ref:{format:"uri",type:"string"},maximum:{type:"integer"},default:{type:"integer"},minimum:{type:"integer"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},title:{type:"string",propertyOrder:1},type:{options:{hidden:!0},type:"string",enum:["integer"]},enum:{format:"table",items:{title:"alternative",type:"integer"},type:"array"},description:{type:"string"}}},propertySchema:{default:{type:"object"},oneOf:[{required:["type"],defaultProperties:["type"],additionalProperties:!1,title:"null type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"null"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},type:{options:{hidden:!0},type:"string",enum:["null"]},description:{type:"string"}}},{required:["type"],defaultProperties:["type"],additionalProperties:!1,title:"boolean type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"boolean"},format:{type:"string",enum:["select","checkbox"]},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},type:{options:{hidden:!0},type:"string",enum:["boolean"]},description:{type:"string"}}},{required:["type"],defaultProperties:["type"],additionalProperties:!1,title:"string type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"string"},format:{type:"string",enum:["color","date","datetime","datetime-local","email","month","number","range","tel","text","textarea","time","url","week","json","sql","xml","yaml"]},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},type:{options:{hidden:!0},type:"string",enum:["string"]},enum:{format:"table",items:{title:"alternative",type:"string"},type:"array"},description:{type:"string"}}},{required:["type"],defaultProperties:["type"],additionalProperties:!1,title:"integer type",type:"object",properties:{$ref:{format:"uri",type:"string"},maximum:{type:"integer"},default:{type:"integer"},minimum:{type:"integer"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},type:{options:{hidden:!0},type:"string",enum:["integer"]},enum:{format:"table",items:{title:"alternative",type:"integer"},type:"array"},description:{type:"string"}}},{required:["type"],defaultProperties:["type"],additionalProperties:!1,title:"number type",type:"object",properties:{$ref:{format:"uri",type:"string"},maximum:{type:"number"},default:{type:"number"},minimum:{type:"number"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},type:{options:{hidden:!0},type:"string",enum:["number"]},enum:{format:"table",items:{title:"alternative",type:"number"},type:"array"},description:{type:"string"}}},{required:["type"],defaultProperties:["type","properties"],additionalProperties:!1,title:"object type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"object"},format:{type:"string",enum:["grid"]},required:{uniqueItems:!0,format:"table",items:{title:"property",type:"string"},type:"array"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},type:{options:{hidden:!0},type:"string",enum:["object"]},description:{type:"string"},properties:{type:"object",patternProperties:{".*":{$ref:"#/definitions/propertySchema"}}}}},{required:["type"],defaultProperties:["type","items"],additionalProperties:!1,title:"array type",type:"object",properties:{$ref:{format:"uri",type:"string"},default:{type:"array"},format:{default:"table",type:"string",enum:["array","table","tabs","tabs-top","checkbox","select","categories"]},items:{$ref:"#/definitions/schema"},$schema:{format:"uri",type:"string"},id:{format:"uri",type:"string"},type:{options:{hidden:!0},type:"string",enum:["array"]},description:{type:"string"}}}],options:{keep_oneof_values:!1},type:"object"}}}},276:function(e,t,a){e.exports=a(324)},299:function(e){e.exports={main:{name:"main",remote:null,live:!1,retry:!1},messages:{name:"messages",remote:"http://localhost:8080/db/messages",live:!0,retry:!1},"message-types":{name:"message-types",remote:null,live:!1,retry:!1},"rewind-points":{name:"rewind-points",remote:"http://localhost:8080//db/rewind-points",live:!0,retry:!1}}},307:function(e,t,a){var r={"./abap":71,"./abap.js":71,"./abc":72,"./abc.js":72,"./actionscript":73,"./actionscript.js":73,"./ada":74,"./ada.js":74,"./apache_conf":75,"./apache_conf.js":75,"./applescript":76,"./applescript.js":76,"./asciidoc":77,"./asciidoc.js":77,"./assembly_x86":78,"./assembly_x86.js":78,"./autohotkey":79,"./autohotkey.js":79,"./batchfile":80,"./batchfile.js":80,"./bro":81,"./bro.js":81,"./c9search":82,"./c9search.js":82,"./c_cpp":83,"./c_cpp.js":83,"./cirru":84,"./cirru.js":84,"./clojure":85,"./clojure.js":85,"./cobol":86,"./cobol.js":86,"./coffee":87,"./coffee.js":87,"./coldfusion":88,"./coldfusion.js":88,"./csharp":89,"./csharp.js":89,"./csound_document":90,"./csound_document.js":90,"./csound_orchestra":91,"./csound_orchestra.js":91,"./csound_score":92,"./csound_score.js":92,"./css":93,"./css.js":93,"./curly":94,"./curly.js":94,"./d":95,"./d.js":95,"./dart":96,"./dart.js":96,"./diff":97,"./diff.js":97,"./django":98,"./django.js":98,"./dockerfile":99,"./dockerfile.js":99,"./dot":100,"./dot.js":100,"./drools":101,"./drools.js":101,"./eiffel":102,"./eiffel.js":102,"./ejs":103,"./ejs.js":103,"./elixir":104,"./elixir.js":104,"./elm":105,"./elm.js":105,"./erlang":106,"./erlang.js":106,"./forth":107,"./forth.js":107,"./fortran":108,"./fortran.js":108,"./ftl":109,"./ftl.js":109,"./gcode":110,"./gcode.js":110,"./gherkin":111,"./gherkin.js":111,"./gitignore":112,"./gitignore.js":112,"./glsl":113,"./glsl.js":113,"./gobstones":114,"./gobstones.js":114,"./golang":115,"./golang.js":115,"./graphqlschema":116,"./graphqlschema.js":116,"./groovy":117,"./groovy.js":117,"./haml":118,"./haml.js":118,"./handlebars":119,"./handlebars.js":119,"./haskell":120,"./haskell.js":120,"./haskell_cabal":121,"./haskell_cabal.js":121,"./haxe":122,"./haxe.js":122,"./hjson":123,"./hjson.js":123,"./html":124,"./html.js":124,"./html_elixir":125,"./html_elixir.js":125,"./html_ruby":126,"./html_ruby.js":126,"./ini":127,"./ini.js":127,"./io":128,"./io.js":128,"./jack":129,"./jack.js":129,"./jade":130,"./jade.js":130,"./java":131,"./java.js":131,"./javascript":132,"./javascript.js":132,"./json":133,"./json.js":133,"./jsoniq":134,"./jsoniq.js":134,"./jsp":135,"./jsp.js":135,"./jssm":136,"./jssm.js":136,"./jsx":137,"./jsx.js":137,"./julia":138,"./julia.js":138,"./kotlin":139,"./kotlin.js":139,"./latex":140,"./latex.js":140,"./lean":141,"./lean.js":141,"./less":142,"./less.js":142,"./liquid":143,"./liquid.js":143,"./lisp":144,"./lisp.js":144,"./live_script":145,"./live_script.js":145,"./livescript":146,"./livescript.js":146,"./logiql":147,"./logiql.js":147,"./lsl":148,"./lsl.js":148,"./lua":149,"./lua.js":149,"./luapage":151,"./luapage.js":151,"./lucene":152,"./lucene.js":152,"./makefile":153,"./makefile.js":153,"./markdown":154,"./markdown.js":154,"./mask":155,"./mask.js":155,"./matlab":156,"./matlab.js":156,"./mavens_mate_log":157,"./mavens_mate_log.js":157,"./maze":158,"./maze.js":158,"./mel":159,"./mel.js":159,"./mips_assembler":160,"./mips_assembler.js":160,"./mipsassembler":161,"./mipsassembler.js":161,"./mushcode":162,"./mushcode.js":162,"./mysql":163,"./mysql.js":163,"./nix":164,"./nix.js":164,"./nsis":165,"./nsis.js":165,"./objectivec":166,"./objectivec.js":166,"./ocaml":167,"./ocaml.js":167,"./pascal":168,"./pascal.js":168,"./perl":169,"./perl.js":169,"./pgsql":170,"./pgsql.js":170,"./php":171,"./php.js":171,"./pig":172,"./pig.js":172,"./plain_text":173,"./plain_text.js":173,"./powershell":174,"./powershell.js":174,"./praat":175,"./praat.js":175,"./prolog":176,"./prolog.js":176,"./properties":177,"./properties.js":177,"./protobuf":178,"./protobuf.js":178,"./python":179,"./python.js":179,"./r":180,"./r.js":180,"./razor":181,"./razor.js":181,"./rdoc":182,"./rdoc.js":182,"./red":183,"./red.js":183,"./rhtml":184,"./rhtml.js":184,"./rst":185,"./rst.js":185,"./ruby":186,"./ruby.js":186,"./rust":187,"./rust.js":187,"./sass":188,"./sass.js":188,"./scad":189,"./scad.js":189,"./scala":190,"./scala.js":190,"./scheme":191,"./scheme.js":191,"./scss":192,"./scss.js":192,"./sh":193,"./sh.js":193,"./sjs":194,"./sjs.js":194,"./smarty":195,"./smarty.js":195,"./snippets":196,"./snippets.js":196,"./soy_template":197,"./soy_template.js":197,"./space":198,"./space.js":198,"./sparql":199,"./sparql.js":199,"./sql":200,"./sql.js":200,"./sqlserver":201,"./sqlserver.js":201,"./stylus":202,"./stylus.js":202,"./svg":203,"./svg.js":203,"./swift":204,"./swift.js":204,"./swig":205,"./swig.js":205,"./tcl":206,"./tcl.js":206,"./tex":207,"./tex.js":207,"./text":208,"./text.js":208,"./textile":209,"./textile.js":209,"./toml":210,"./toml.js":210,"./tsx":211,"./tsx.js":211,"./turtle":212,"./turtle.js":212,"./twig":213,"./twig.js":213,"./typescript":214,"./typescript.js":214,"./vala":215,"./vala.js":215,"./vbscript":216,"./vbscript.js":216,"./velocity":217,"./velocity.js":217,"./verilog":218,"./verilog.js":218,"./vhdl":219,"./vhdl.js":219,"./wollok":220,"./wollok.js":220,"./xml":221,"./xml.js":221,"./xquery":222,"./xquery.js":222,"./yaml":223,"./yaml.js":223};function n(e){var t=i(e);return a(t)}function i(e){var t=r[e];if(!(t+1)){var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}return t}n.keys=function(){return Object.keys(r)},n.resolve=i,e.exports=n,n.id=307},310:function(e,t,a){var r={"./ambiance":224,"./ambiance.js":224,"./chaos":225,"./chaos.js":225,"./chrome":226,"./chrome.js":226,"./clouds":227,"./clouds.js":227,"./clouds_midnight":228,"./clouds_midnight.js":228,"./cobalt":229,"./cobalt.js":229,"./crimson_editor":230,"./crimson_editor.js":230,"./dawn":231,"./dawn.js":231,"./dracula":232,"./dracula.js":232,"./dreamweaver":233,"./dreamweaver.js":233,"./eclipse":234,"./eclipse.js":234,"./github":235,"./github.js":235,"./gob":236,"./gob.js":236,"./gruvbox":237,"./gruvbox.js":237,"./idle_fingers":238,"./idle_fingers.js":238,"./iplastic":239,"./iplastic.js":239,"./katzenmilch":240,"./katzenmilch.js":240,"./kr_theme":241,"./kr_theme.js":241,"./kuroir":242,"./kuroir.js":242,"./merbivore":243,"./merbivore.js":243,"./merbivore_soft":244,"./merbivore_soft.js":244,"./mono_industrial":245,"./mono_industrial.js":245,"./monokai":246,"./monokai.js":246,"./pastel_on_dark":247,"./pastel_on_dark.js":247,"./solarized_dark":248,"./solarized_dark.js":248,"./solarized_light":249,"./solarized_light.js":249,"./sqlserver":250,"./sqlserver.js":250,"./terminal":251,"./terminal.js":251,"./textmate":252,"./textmate.js":252,"./tomorrow":253,"./tomorrow.js":253,"./tomorrow_night":254,"./tomorrow_night.js":254,"./tomorrow_night_blue":255,"./tomorrow_night_blue.js":255,"./tomorrow_night_bright":256,"./tomorrow_night_bright.js":256,"./tomorrow_night_eighties":257,"./tomorrow_night_eighties.js":257,"./twilight":258,"./twilight.js":258,"./vibrant_ink":259,"./vibrant_ink.js":259,"./xcode":260,"./xcode.js":260};function n(e){var t=i(e);return a(t)}function i(e){var t=r[e];if(!(t+1)){var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}return t}n.keys=function(){return Object.keys(r)},n.resolve=i,e.exports=n,n.id=310},324:function(e,t,a){"use strict";a.r(t);var r=a(1),n=a.n(r),i=a(51),s=a.n(i),o=a(17),l=a(346),c=a(347),u=a(348),p=a(8),d=a(29),m=d.a.create({main:{padding:"15px 0"}}),h=a(345),g="PUSH_MESSAGES",f="REMOVE_ALL_MESSAGES",b="UPDATE_MESSAGES",y="SAVE_DRAFT",j="SEND_DRAFT_MESSAGE";function v(e){return{type:y,payload:{message:e}}}var w="ADD_CHAT",O="REMOVE_CHAT";var E="CREATE_REWIND_POINT",k="REMOVE_REWIND_POINT",_="SELECT_REWIND_POINT",S="UPDATE_REWIND_POINTS";var x,C=["height","color","weight"],I="name",D="table",T=a(9),M=a(14),P=a(13),R=a(11),N=a(3),q=a(12),F=a(332),A=a(333),$=a(334),V=a(335),B=a(329),U=a(330),W=a(331),z=a(326),L=a(266),G=a(21),H=a.n(G),J=a(59),Y=a.n(J),Z=a(7),K={showOnGameControlCreateChats:!0,addChatIdToChatFromArray:!0,addChatIdToChatToArray:!0,preFillFrom:!1},X=[{chatId:"red",label:"Red Chat",options:Object(Z.a)({},K)},{chatId:"blue",label:"Blue Chat",options:Object(Z.a)({},K)},{chatId:"white",label:"White Chat",options:Object(Z.a)({},K,{addChatIdToChatToArray:!1,preFillFrom:!0})}],Q=function(){return X.filter(function(e){return e.options.showOnGameControlCreateChats})},ee=X,te=a(327),ae=a(328),re=a(349),ne=function(e){var t=e.createRewindPoint,a=n.a.createRef();return n.a.createElement(z.a,null,n.a.createElement("form",{onSubmit:function(e){e.preventDefault(),a.current.value&&a.current.value.length&&(t(a.current.value),a.current.value="")}},n.a.createElement(te.a,null,n.a.createElement(ae.a,{innerRef:a,placeholder:"New rewind point"}),n.a.createElement(re.a,{addonType:"append"},n.a.createElement(L.a,{color:"warning"},"Create")))))},ie=d.a.create({main:{padding:"15px 0"},hide:{display:"none"},createMessage:{display:"none"},createMessageShow:{display:"block"}}),se=function(e){var t=e.rewinds,a=(e.removeRewindPoint,e.selectRewindPoint);return n.a.createElement(B.a,{className:Object(p.css)(!t.length&&ie.hide)},n.a.createElement("p",null,"Rewind Points:"),n.a.createElement(U.a,null,t.map(function(e,t){var r=e.doc;return n.a.createElement(W.a,{key:t,tag:"button",active:r.active,onClick:function(){a(r._id)}},r.name)})))},oe=Object(o.b)(function(e){return{rewinds:e.rewindPoints.points,active:e.rewindPoints.activeRewind}},function(e){return{removeRewindPoint:function(t){e({type:k,payload:{id:t}})},selectRewindPoint:function(t){e({type:_,payload:{id:t}})}}})(se),le=function(e){function t(e,a){var r;return Object(T.a)(this,t),(r=Object(P.a)(this,Object(R.a)(t).call(this,e,a))).newMessageForm=r.newMessageForm.bind(Object(N.a)(r)),r.closeMessageForm=r.closeMessageForm.bind(Object(N.a)(r)),r.injectForm=r.injectForm.bind(Object(N.a)(r)),r.generateMessages=r.generateMessages.bind(Object(N.a)(r)),r.editor=null,r.editorRef=n.a.createRef(),r.state={activeSchema:null,createChats:Q()},r}return Object(q.a)(t,e),Object(M.a)(t,[{key:"generateMessages",value:function(e){var t=this;this.props.createMessages(Array.apply(null,Array(e)).map(function(){var e=t.props.messageTypes[Math.floor(Math.random()*t.props.messageTypes.length)];return e.required.reduce(function(t,a){var r="",n=e.properties[a].enum;if(Array.isArray(n)&&n.length)r=n[Math.floor(Math.random()*n.length)];else if("color"===e.properties[a].format)r="#"+Math.floor(16777215*Math.random()).toString(16);else switch(e.properties[a].type){case"integer":r=Math.floor(999*Math.random());break;case"string":r=Y()({count:1});break;default:r=e.properties[a].default||Y()({count:1})}return t[a]=r,t},{})}))}},{key:"newMessageForm",value:function(e){if(this.state.activeSchema!==e.target.name){this.editor&&this.editor.destroy(),this.setState({activeSchema:e.target.name});var t=this.props.messageTypes[e.target.name];t.properties.from.enum=t.properties.from.enum.sort(function(e,t){return"white"===e?-1:"white"===t?1:0}),this.editor=new H.a(this.editorRef.current,{schema:t,theme:"bootstrap4"})}else this.closeMessageForm()}},{key:"closeMessageForm",value:function(){this.editor.destroy(),this.setState({activeSchema:null})}},{key:"injectForm",value:function(){this.editor.validate().length||(this.props.createMessages([this.editor.getValue()]),this.closeMessageForm())}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:Object(p.css)(ie.main)},n.a.createElement(F.a,{className:"main"},n.a.createElement(A.a,{md:4},n.a.createElement($.a,null,n.a.createElement(V.a,null,"Game Control"),n.a.createElement(B.a,null,n.a.createElement("p",null,"Inject Messages:"),n.a.createElement(U.a,null,this.props.messageTypes.map(function(t,a){return n.a.createElement(W.a,{key:a,tag:"button",active:a===parseInt(e.state.activeSchema),onClick:e.newMessageForm,name:a},t.title)}))),!!this.state.createChats.length&&n.a.createElement(B.a,null,n.a.createElement("p",null,"Create chats:"),n.a.createElement(U.a,null,this.state.createChats.map(function(t,a){var r=e.props.chats.includes(t.chatId);return n.a.createElement(W.a,{key:a,tag:"button",active:r,onClick:function(){r?e.props.removeChat(t.chatId):e.props.createChat(t)}},t.label)}))),n.a.createElement(ne,{createRewindPoint:this.props.createRewindPoint}),n.a.createElement(oe,null),n.a.createElement(z.a,null,n.a.createElement(L.a,{block:!0,color:"success",onClick:function(){e.generateMessages(50)}},"Generate 50 Messages"),n.a.createElement(L.a,{block:!0,color:"success",onClick:function(){e.generateMessages(100)}},"Generate 100 Messages"),n.a.createElement(L.a,{block:!0,color:"success",onClick:function(){e.generateMessages(1e3)}},"Generate 1000 Messages")),n.a.createElement(z.a,null,n.a.createElement(L.a,{block:!0,color:"danger",onClick:this.props.clearMessages},"Clear Messages")))),n.a.createElement(A.a,{md:8},n.a.createElement("div",{className:Object(p.css)(ie.createMessage,this.state.activeSchema&&ie.createMessageShow)},n.a.createElement($.a,null,n.a.createElement(B.a,null,n.a.createElement("div",{ref:this.editorRef})),n.a.createElement(z.a,null,n.a.createElement(L.a,{color:"success",onClick:this.injectForm},"Inject")))))))}}]),t}(r.Component),ce=Object(o.b)(function(e){return{messageTypes:e.messageTypes.filter(function(e){return C.includes(e.scheme)}),chats:e.chats.map(function(e){return e&&e.id})}},function(e){return{createMessages:function(t){e(function(e){return{type:g,payload:{messages:e}}}(t))},clearMessages:function(){e({type:f})},createChat:function(t){e(function(e){var t=e.chatId,a=e.label;return{type:w,payload:{chat:{id:t,label:a}}}}(t))},removeChat:function(t){e({type:O,payload:t})},createRewindPoint:function(t){e(function(e,t){return{type:E,payload:{name:e,db:t}}}(t,"messages"))}}})(le),ue=d.a.create({chatItem:{paddingBottom:"15px"}}),pe=p.StyleSheet.create({main:{height:"320px",position:"relative",paddingTop:"0.1px",":after":{content:'""',display:"block",position:"absolute",width:"100%",height:"20px",top:"100%",background:"linear-gradient(to bottom, rgba(255,255,255,0) 0%,rgba(255,255,255,1) 100%)",left:"0"},":before":{content:'""',display:"block",position:"absolute",width:"100%",height:"20px",bottom:"100%",left:"0",zIndex:"2",background:"linear-gradient(to bottom, rgba(255,255,255,1) 0%,rgba(255,255,255,0) 100%)"}},container:{position:"absolute",maxHeight:"100%",height:"auto",left:"0",bottom:"0",width:"100%"},item:{display:"inline-block",verticalAligin:"top",maxWidth:"100%"},scrolContent:{padding:"20px"},badge:{maxWidth:"100%",fontSize:"16px",lineHeight:"20px",padding:"5px 15px",borderRadius:"15px 0 15px 15px",position:"relative",overflow:"hidden",display:"inline-block",verticalAligin:"top",opacity:"0.9",color:"#fff",":hover":{opacity:"1"}},badgeLeft:{borderRadius:"0 15px 15px 15px"},badgeBg:{opacity:"0.8",position:"absolute",left:"0",bottom:"0",height:"100%",width:"100%"},message:{position:"relative"},scrollbar:{boxSizing:"content-box",width:"100%",padding:"20px",margin:"-20px 0 0 -20px",position:"relative",height:"100%"}}),de=a(268),me=a.n(de),he={blue:"bg-primary",gray:"bg-secondary",green:"bg-success",red:"bg-danger",yellow:"bg-warning",black:"bg-dark",white:"bg-white",lightBlue:"bg-info",lightGray:"bg-light",lightBlack:"bg-muted"},ge={transparent:"link",blue:"primary",gray:"secondary",green:"success",red:"danger",yellow:"warning",lightBlue:"info"},fe={blue:"text-primary",gray:"text-secondary",green:"text-success",red:"text-danger",yellow:"text-warning",black:"text-dark",white:"text-white",lightBlue:"text-info",lightGray:"text-light",lightBlack:"text-muted"},be=function(){function e(t){Object(T.a)(this,e),this.itemId=t,this.items={},this.itemDefault={},this.global={}}return Object(M.a)(e,[{key:"getGlobalScheme",value:function(){return this.global}},{key:"getItemScheme",value:function(){return Object(Z.a)({},this.itemDefault,this.items[this.itemId]||{})}},{key:"getScheme",value:function(){return{item:this.getItemScheme(),global:this.getGlobalScheme()}}}]),e}(),ye=function(e){function t(e){var a;return Object(T.a)(this,t),(a=Object(P.a)(this,Object(R.a)(t).call(this,e))).items={red:{bg:he.red},blue:{bg:he.blue}},a.itemDefault={bg:he.gray,text:fe.white},a}return Object(q.a)(t,e),t}(be),je=a(60),ve=a.n(je),we=function(e){function t(e,a){var n;return Object(T.a)(this,t),(n=Object(P.a)(this,Object(R.a)(t).call(this,e,a))).timeId=null,n.loadTimeId=null,n.loading=!1,n.scrolledDown=!0,n.scrollbar=Object(r.createRef)(),n.loadMoreCount=10,n.getScrollHeight=n.getScrollHeight.bind(Object(N.a)(n)),n.onScrollUp=n.onScrollUp.bind(Object(N.a)(n)),n.onYReachStart=n.onYReachStart.bind(Object(N.a)(n)),n.onYReachEnd=n.onYReachEnd.bind(Object(N.a)(n)),n.scrollToDown=n.scrollToDown.bind(Object(N.a)(n)),n.firstScrolled=!1,n.state={showItemsCount:10},n}return Object(q.a)(t,e),Object(M.a)(t,[{key:"componentWillUnmount",value:function(){clearTimeout(this.loadTimeId)}},{key:"onScrollUp",value:function(){this.scrolledDown=!1}},{key:"onYReachEnd",value:function(){this.scrolledDown=!0}},{key:"onYReachStart",value:function(){var e=this;this.loadTimeId&&clearTimeout(this.loadTimeId),this.loadTimeId=setTimeout(function(){var t=e.getScrollHeight();e.scrolledDown||e.loading||(e.loading=!0,e.setState({showItemsCount:e.state.showItemsCount+e.loadMoreCount}),setTimeout(function(){e.scrollbar.current&&(e.scrollbar.current._container.scrollTop=e.getScrollHeight()-t),e.loading=!1}))})}},{key:"getScrollHeight",value:function(){return this.scrollbar.current?this.scrollbar.current._container.scrollHeight:0}},{key:"scrollToDown",value:function(){var e=this;this.timeId&&clearTimeout(this.timeId),this.timeId=setTimeout(function(){e.scrollbar.current?(e.scrollbar.current._container.scrollTop=e.getScrollHeight(),e.firstScrolled=!0):e.firstScrolled||(e.timeId=setTimeout(function(){e.scrollToDown()},512))})}},{key:"componentWillReceiveProps",value:function(e){if(0!==this.props.messages.length&&e.messages.length>this.state.showItemsCount&&this.props.messages.length<e.messages.length){var t=e.messages.length-this.props.messages.length;this.setState({showItemsCount:this.state.showItemsCount+(t>this.loadMoreCount?this.loadMoreCount:t)})}this.scrollToDown()}},{key:"renderItem",value:function(e){if(!e)return"";var t=e.from===this.props.chatId,a=new ye(e.from).getItemScheme(),r={};return t&&(r={textAlign:"right"}),n.a.createElement("div",{style:r},n.a.createElement("div",{className:Object(p.css)(pe.item)},n.a.createElement("div",{className:Object(p.css)(pe.badge,!t&&pe.badgeLeft)},n.a.createElement("div",{className:ve()(Object(p.css)(pe.badgeBg),a.bg)}),n.a.createElement("div",{className:ve()(Object(p.css)(pe.message),a.text)},Object.keys(e).map(function(t){return"_"!==t.charAt(0)&&e[t]&&n.a.createElement("div",{key:t},n.a.createElement("strong",null,t,":")," ",e[t])})))))}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:Object(p.css)(pe.main)},n.a.createElement("div",{className:Object(p.css)(pe.scrollbar)},n.a.createElement(me.a,{ref:this.scrollbar,onYReachEnd:this.onYReachEnd,onScrollUp:this.onScrollUp,onYReachStart:this.onYReachStart,suppressScrollX:!0,className:Object(p.css)(pe.container),contentClassName:Object(p.css)(pe.scrolContent)},n.a.createElement("div",{className:Object(p.css)(pe.scrolContent)},this.props.messages.slice(Math.max(this.props.messages.length-this.state.showItemsCount,0)).map(function(t,a){return n.a.createElement("div",{key:a},e.renderItem(t.doc))})))))}}]),t}(r.Component),Oe=Object(o.b)(function(e,t){var a=t.chatId;return{messages:e.messages&&Array.isArray(e.messages[a])?e.messages[a]:[],chatId:a}},function(e){return{}})(we),Ee=a(6),ke=a.n(Ee),_e=function(e){function t(e){var a;return Object(T.a)(this,t),(a=Object(P.a)(this,Object(R.a)(t).call(this,e))).items={red:{bg:he.red,text:fe.white},blue:{bg:he.blue,text:fe.white}},a.itemDefault={bg:he.lightGray,text:fe.black,btn:ge.gray},a.global={body:he.white,footer:he.light,tab:he.white,activeTab:ke()(he.blue,fe.white)},a}return Object(q.a)(t,e),t}(be),Se=a(53),xe=a(269);try{x=a(299)}catch(na){x={}}x=Object(Z.a)({},xe,x);var Ce=Object(Z.a)({},x),Ie=function(e,t,a){if(!x[e]&&!a)return new Se.a(e);a||(a={});var r=x[e]?Object(Z.a)({},x[e],a):a,n=new Se.a(r.name||e);if(r.remote&&t){var i=new Se.a(r.remote);n.replicate.to(i,{live:r.live,retry:r.retry}).on("complete",function(e){console.log("complete",e)}),n.replicate.from(i,{live:r.live,retry:r.retry}).on("complete",function(e){console.log("complete from",e)})}return n},De={};ee.forEach(function(e){var t=e.chatId;De[t]={map:'function (doc) { if(doc.to === "'.concat(t,'" && doc.draft === false || doc.from === "').concat(t,'") emit(doc.id); }')}});var Te={messages:De},Me=function e(t,a,r){var n=a.split("/")[0];return t.query(a,r).catch(function(i){if(!Te[n])throw new Error("View "+n+" is not defined.");if(404===i.status)return t.put({_id:"_design/"+n,views:Te[n]}).then(function(){return e(t,a,r)})})},Pe={cloneFilter:"function (doc) { return !doc._deleted; }"};ee.forEach(function(e){var t=e.chatId;Pe[t]='function (doc) { return doc.to === "'.concat(t,'" && doc.draft === false || doc.from === "').concat(t,'"; }')});var Re={messages:Pe},Ne="filter",qe=p.StyleSheet.create({label:{position:"absolute",top:0,right:0},labelContainer:{position:"relative",width:"100%"},labelButton:{paddingRight:"0 !important",paddingLeft:"0 !important"}}),Fe=function(e){var t=e.colorScheme,a=e.button,r=e.children,i=e.chatId,s=e.defaultMessageType,o=e.createDraft;return n.a.createElement(V.a,{className:t.item.bg},n.a.createElement("div",{className:Object(p.css)(qe.labelContainer)},n.a.createElement("div",{className:Object(p.css)(qe.label)},n.a.createElement(L.a,{color:"link",className:Object(p.css)(qe.labelButton)},n.a.createElement("strong",{className:t.item.text},r)))),a&&s&&n.a.createElement(L.a,{color:t.item.btn,onClick:function(){var e={};s.required.forEach(function(t){var a="",r=s.properties[t].enum;Array.isArray(r)&&r.length?a="from"===t&&r.includes(i)?i:s.properties[t].default?s.properties[t].default:r[0]:s.properties[t].default&&(a=s.properties[t].default),e[t]=a}),o(e)}},a))};Fe.defaultValues={button:"",children:""};var Ae=Fe,$e=Object(o.b)(function(e){return{defaultMessageType:e.messageTypes.find(function(e){return e.scheme===I})}},function(e){return{createDraft:function(t){e(v(t))}}})(Ae),Ve=a(336),Be=a(337),Ue=a(338),We=a(339),ze=a(340),Le=a(341),Ge=a(342),He=a(343),Je=a(344),Ye=a(32),Ze=a(35),Ke=function(e){function t(e,a){var r;return Object(T.a)(this,t),(r=Object(P.a)(this,Object(R.a)(t).call(this,e,a))).initForm=r.initForm.bind(Object(N.a)(r)),r.submitForm=r.submitForm.bind(Object(N.a)(r)),r.getFormFilteredData=r.getFormFilteredData.bind(Object(N.a)(r)),r.editor=null,r.editorBox=n.a.createRef(),r.hiddenAutofillKeys=["draft","_id","_rev","from","test"],r}return Object(q.a)(t,e),Object(M.a)(t,[{key:"componentDidMount",value:function(){this.initForm()}},{key:"componentWillReceiveProps",value:function(e){this.editor&&this.editor.setValue(this.getFormFilteredData(e.form,e.message).values)}},{key:"getFormFilteredData",value:function(e,t){var a=Object(Z.a)({},e,{required:["_id"].concat(Object(Ze.a)(e.required)),properties:Object(Z.a)({},e.properties)}),r=Object(Z.a)({},t);return this.hiddenAutofillKeys.forEach(function(e){var t=a.required.indexOf(e);t>-1&&a.required.splice(t,1),a.properties[e]&&delete a.properties[e],r[e]&&delete r[e]}),{form:a,values:r}}},{key:"initForm",value:function(){var e=this,t=this.getFormFilteredData(this.props.form,this.props.message);this.editor=new H.a(this.editorBox.current,{schema:t.form,theme:"bootstrap4"}).setValue(t.values);var a=function(t){e.editor.editors.hasOwnProperty(t)&&"root"!==t&&e.editor.watch(t,function(a){e.props.saveDraft(Object(Z.a)({},e.props.message,e.editor.getValue(),Object(Ye.a)({},t.replace("root.",""),e.editor.getEditor(t).getValue())))})};for(var r in this.editor.editors)a(r)}},{key:"submitForm",value:function(){this.editor.validate().length||this.props.sendDraftMessage(Object(Z.a)({},this.props.message,this.editor.getValue()))}},{key:"render",value:function(){return n.a.createElement("div",{className:"messageEdit"},n.a.createElement("div",{ref:this.editorBox}),n.a.createElement(L.a,{onClick:this.submitForm},this.props.button))}}]),t}(r.Component),Xe=function(e){function t(e,a){var r;return Object(T.a)(this,t),(r=Object(P.a)(this,Object(R.a)(t).call(this,e,a))).renderDropdown=r.renderDropdown.bind(Object(N.a)(r)),r.toggle=r.toggle.bind(Object(N.a)(r)),r.toggleDropdown=r.toggleDropdown.bind(Object(N.a)(r)),r.renderTabs=r.renderTabs.bind(Object(N.a)(r)),r.showDropdownAfter=3,r.state={activeDraft:e.messages.length-1,dropdownOpen:!1},r}return Object(q.a)(t,e),Object(M.a)(t,[{key:"componentWillReceiveProps",value:function(e){this.props.messages.length!==e.messages.length&&this.toggle(e.messages.length-1)}},{key:"toggle",value:function(e){this.setState({activeDraft:e})}},{key:"toggleDropdown",value:function(){this.setState({dropdownOpen:!this.state.dropdownOpen})}},{key:"renderDropdown",value:function(){var e=this;return n.a.createElement(Ve.a,{isOpen:this.state.dropdownOpen,toggle:this.toggleDropdown},n.a.createElement(Be.a,{caret:!0,className:this.props.colorScheme.global.activeTab},this.props.messages[this.state.activeDraft].doc.title||"Draft ".concat(this.state.activeDraft)),n.a.createElement(Ue.a,{right:!0},this.props.messages.map(function(t,a){return n.a.createElement(We.a,{key:a,className:e.state.activeDraft===a?e.props.colorScheme.global.activeTab:"",onClick:function(){e.toggle(a)}},t.doc.title||"Draft ".concat(a))})))}},{key:"renderTabs",value:function(){var e=this;return this.props.messages.length<2?n.a.createElement("div",null):n.a.createElement(ze.a,{tabs:!0},this.props.messages.map(function(t,a){return n.a.createElement(Le.a,{key:a},n.a.createElement(Ge.a,{className:e.state.activeDraft===a?e.props.colorScheme.global.activeTab:e.props.colorScheme.global.tab,onClick:function(){e.toggle(a)}},t.doc.title?t.doc.title:"Draft ".concat(a+1)))}))}},{key:"render",value:function(){var e=this;return n.a.createElement(z.a,{className:this.props.colorScheme.global.footer},this.props.messages.length>0&&n.a.createElement(He.a,{activeTab:this.state.activeDraft+""},this.props.messages.length>this.showDropdownAfter?this.renderDropdown():this.renderTabs(),this.props.messages.map(function(t,a){return n.a.createElement(Je.a,{key:a,tabId:a+""},n.a.createElement(Ke,{message:t.doc,button:e.props.button,form:e.props.form,saveDraft:e.props.saveDraft,sendDraftMessage:e.props.sendDraftMessage}))})))}}]),t}(r.Component),Qe=Object(o.b)(function(e,t){var a=t.chatId;return{messages:e.messages&&Array.isArray(e.messages[a])?e.messages[a].filter(function(e){return e.doc.draft}):[],form:Object(Z.a)({},e.messageTypes.find(function(e){return e.scheme===I}),{format:D})}},function(e){return{sendDraftMessage:function(t){e({type:j,payload:{message:t}})},saveDraft:function(t){e(v(t))}}})(Xe),et=function(e){function t(e,a){var r;return Object(T.a)(this,t),(r=Object(P.a)(this,Object(R.a)(t).call(this,e,a))).updateState=function(e){r.changeTimer&&clearTimeout(r.changeTimer),r.changeTimer=setTimeout(function(){console.log(r.db),Me(r.db,"messages/"+r.props.chatId,{include_docs:!0,filter:Ne+"messages/"+r.props.chatId}).then(function(t){var a=t.rows;console.log(a),r.props.updateMessages(a||[],r.props.chatId),"function"===typeof e&&e()})},r.changeTime)},r.changeTimer=null,r.changeTime=128,r.updateState=r.updateState.bind(Object(N.a)(r)),r.initDatabase=r.initDatabase.bind(Object(N.a)(r)),r.dbName="messages",r.db=null,r.changes=null,r.state={colorScheme:new _e(e.chatId).getScheme()},r}return Object(q.a)(t,e),Object(M.a)(t,[{key:"componentWillMount",value:function(){this.initDatabase(this.props.chatId,this.props.activeRewind)}},{key:"componentWillReceiveProps",value:function(e){this.initDatabase(e.chatId,e.activeRewind)}},{key:"initDatabase",value:function(e,t){var a,r,n=this,i=t&&t.doc.local!==this.dbName,s=!this.db;(this.props.chatId!==e||i||s||this.props.activeRewind&&!t)&&(this.changes&&this.changes.cancel(),i?(this.dbName=t.doc.local,this.db=Ie(this.dbName,!1,Object(Z.a)({},Ce.messages,{name:t.doc.local,remote:Ce.messages.remote?Ce.messages.remote.replace("messages",this.dbName):null})),s=!0):(s||"messages"!==this.dbName)&&(s=!0,this.dbName="messages",this.db=Ie(this.dbName)),s&&this.updateState(),this.changes=(a=this.db,r="messages/"+e,a.changes({since:"now",live:!0,include_docs:!0,filter:Ne+r})).on("change",function(){n.updateState()}),this.setState({colorScheme:new _e(e).getScheme()}))}},{key:"componentWillUnmount",value:function(){this.changes.cancel(),clearTimeout(this.changeTimer)}},{key:"render",value:function(){return n.a.createElement($.a,null,n.a.createElement($e,{colorScheme:this.state.colorScheme,button:"Add >>",chatId:this.props.chatId},this.props.label),n.a.createElement(B.a,{className:this.state.colorScheme.global.body},n.a.createElement(Oe,{chatId:this.props.chatId})),n.a.createElement(Qe,{colorScheme:this.state.colorScheme,button:"Send",chatId:this.props.chatId}))}}]),t}(r.Component),tt=Object(o.b)(function(e){return{activeRewind:e.rewindPoints.points.filter(function(e){return e.doc.active})[0]}},function(e){return{updateMessages:function(t,a){e(function(e,t){return{type:b,payload:{messages:e,chatId:t}}}(t,a))}}})(et),at=12,rt=6,nt=4,it=function(e){var t=e.chats,a=e.form;return n.a.createElement(F.a,null,t.map(function(e,t){return e&&n.a.createElement(A.a,{xs:at,sm:rt,md:nt,key:t},n.a.createElement("div",{className:Object(p.css)(ue.chatItem)},n.a.createElement(tt,{chatId:e.id,label:e.label,form:a})))}))},st=Object(o.b)(function(e){return{chats:e.chats,form:Object(Z.a)({},e.messageTypes.find(function(e){return e.scheme===I}),{format:D})}},function(e){return{}})(it),ot=function(){return n.a.createElement(h.a,{fluid:!0},n.a.createElement("div",{className:Object(p.css)(m.main)},n.a.createElement(st,null),n.a.createElement(ce,null)))},lt=d.a.create({main:{padding:"15px 0"},devSection:{paddingTop:"15px"}}),ct=a(271);function ut(e){this.jsonEditor=null,this.renderZone="string"===typeof e?document.getElementById(e):e.current}function pt(e){ut.call(this,e)}function dt(e){ut.call(this,e);var t=function(e){if(e.matches('div[data-schemapath$=".properties"] > h3 > div > button.json-editor-btntype-properties')){var t=e.parentElement.parentElement.parentElement.querySelector("h3 > span");if(t&&"properties"===t.innerText)return!0}return!1};this.observer=new MutationObserver(function(e,a){var r=!0,n=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){s.value.addedNodes.forEach(function(e){if(1==e.nodeType)if(t(e))e.querySelector("span").innerText="Add/Remove";else if(e.matches("button.json-editor-btntype-properties")){var a=e.querySelector("i");a.classList.remove("fa-pen"),a.classList.add("fa-cog"),e.querySelector("span").innerText=""}})}}catch(l){n=!0,i=l}finally{try{r||null==o.return||o.return()}finally{if(n)throw i}}}),this.observer.observe(this.renderZone,{childList:!0,subtree:!0})}ut.prototype.destroy=function(){this.jsonEditor&&(this.jsonEditor.destroy(),this.jsonEditor=null)},ut.prototype.updateSchema=function(e){this.destroy(),this.jsonEditor=new H.a(this.renderZone,{schema:e})},ut.prototype.validate=function(){return this.jsonEditor.validate()},ut.prototype.getJSON=function(){return this.jsonEditor.getValue()},pt.prototype=Object.create(ut.prototype),Object.defineProperty(pt.prototype,"constructor",{value:pt,enumerable:!1,writable:!0}),pt.prototype.updateSchema=function(e){this.destroy(),this.jsonEditor=new H.a(this.renderZone,{schema:e,no_additional_properties:!0})},dt.prototype=Object.create(ut.prototype),Object.defineProperty(dt.prototype,"constructor",{value:dt,enumerable:!1,writable:!0}),dt.prototype.updateSchema=function(e){this.destroy();this.jsonEditor=new H.a(this.renderZone,{schema:e,custom_validators:[function(e,t,a){var r=[];return"integer"===t.type&&"range"===t.format&&("undefined"!==typeof t.minimum&&"undefined"!==typeof t.maximum||r.push({path:a,property:"format",message:"The range format requires that you specify both minimum and maximum properties, too."})),r},function(e,t,a){var r=[];return"integer"!==t.type&&"number"!==t.type||"undefined"!==typeof t.minimum&&"undefined"!==typeof t.minimum&&t.minimum>t.maximum&&r.push({path:a,property:"maximum",message:"The maximum value must be greater than or equal than the minimum value."}),r}]});this.jsonEditor.on("ready",function(){var e=this.root.getButton("Save","save","Save"),t=this.root.theme.getHeaderButtonHolder();t.appendChild(e),this.root.header.parentNode.insertBefore(t,this.root.header.nextSibling);var a=this;e.addEventListener("click",function(e){e.preventDefault();var t=a.getValue(),r=new Blob([JSON.stringify(t,null,2)],{type:"application/json;charset=utf-8"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(r,"schema.json");else{var n=document.createElement("a");n.download="schema.json",n.href=URL.createObjectURL(r),n.dataset.downloadurl=["text/plain",n.download,n.href].join(":"),n.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1}))}},!1)})};var mt=function(e){function t(e,a){var r;return Object(T.a)(this,t),(r=Object(P.a)(this,Object(R.a)(t).call(this,e,a))).schemaEditor=null,r.editorBox=n.a.createRef(),r.onChange=r.onChange.bind(Object(N.a)(r)),r.updateEditor=r.updateEditor.bind(Object(N.a)(r)),r.saved="",r.value=r.props.defaultValue,r}return Object(q.a)(t,e),Object(M.a)(t,[{key:"onChange",value:function(e,t){this.schemaEditor.validate().length?alert("Invalid schema"):this.props.onChange&&(this.value=this.schemaEditor.jsonEditor.getValue(),this.props.onChange(this.schemaEditor.getJSON()))}},{key:"componentDidMount",value:function(){this.schemaEditor=new dt("schema-editor"),this.updateEditor(this.props.schema,this.props.options,this.props.defaultValue)}},{key:"componentWillReceiveProps",value:function(e){var t=e.schema,a=e.options;this.updateEditor(t,a)}},{key:"updateEditor",value:function(e,t,a){try{var r=JSON.stringify(e);r===this.save&&t.counter===this.props.options.counter||(H.a.defaults.options.object_layout=t.layout,H.a.defaults.options=Object(Z.a)({},H.a.defaults.options,t.booleanOptions),this.save=r,this.schemaEditor.updateSchema(e),this.schemaEditor.jsonEditor.setValue(this.value),this.schemaEditor.jsonEditor.on("change",this.onChange))}catch(n){alert("Invalid json schema"),console.log(n)}}},{key:"render",value:function(){return n.a.createElement($.a,null,n.a.createElement(V.a,null,"Schema Editor"),n.a.createElement(B.a,null,n.a.createElement("div",{id:"schema-editor"})),n.a.createElement(z.a,null))}}]),t}(r.Component),ht=function(e){function t(e,a){var r;return Object(T.a)(this,t),(r=Object(P.a)(this,Object(R.a)(t).call(this,e,a))).previewBox=n.a.createRef(),r.editorPreview=null,r}return Object(q.a)(t,e),Object(M.a)(t,[{key:"componentDidMount",value:function(){this.editorPreview=new pt("editor-preview")}},{key:"componentWillReceiveProps",value:function(e){var t=e.schema;this.editorPreview.destroy(),this.editorPreview.updateSchema(t)}},{key:"render",value:function(){return n.a.createElement($.a,null,n.a.createElement(V.a,null,"Editor Preview"),n.a.createElement(B.a,null,n.a.createElement("div",{id:"editor-preview",ref:this.previewBox})),n.a.createElement(z.a,null,"The Editor Preview will be updated as you make changes in the Schema Editor"))}}]),t}(r.Component),gt=a(272),ft=a.n(gt),bt=function(e){function t(e,a){var r;return Object(T.a)(this,t),(r=Object(P.a)(this,Object(R.a)(t).call(this,e,a))).editorBox=n.a.createRef(),r.onChange=r.onChange.bind(Object(N.a)(r)),r.setEditorValue=r.setEditorValue.bind(Object(N.a)(r)),r.onUpdateClick=r.onUpdateClick.bind(Object(N.a)(r)),r.saveJson="",r.state={},r}return Object(q.a)(t,e),Object(M.a)(t,[{key:"onChange",value:function(e,t){}},{key:"componentDidMount",value:function(){this.setEditorValue(JSON.stringify(this.props.value,null,2))}},{key:"componentWillRecivedProps",value:function(e){var t=e.value;this.setEditorValue(JSON.stringify(t,null,2))}},{key:"setEditorValue",value:function(e){this.editorBox.current&&this.saveJson!==e&&(this.saveJson=e,this.editorBox.current.editor.setValue(this.saveJson),this.editorBox.current.editor.session.getSelection().clearSelection(),this.editorBox.current.editor.resize())}},{key:"onUpdateClick",value:function(){this.props.onSchemaSubmit(this.editorBox.current.editor.getValue())}},{key:"render",value:function(){return n.a.createElement($.a,null,n.a.createElement(V.a,null,"Meta Schema"),n.a.createElement(B.a,{style:{padding:0}},n.a.createElement(ft.a,{mode:"json",theme:"monokai",setReadOnly:!1,onChange:this.onChange,style:{height:"400px"},ref:this.editorBox})),n.a.createElement(z.a,null,n.a.createElement(L.a,{onClick:this.onUpdateClick},"Update Schema Editor")))}}]),t}(r.Component),yt=[{value:"required_by_default",label:"Object properties required by default",selected:!1},{value:"display_required_only",label:"Only show required properties by default",selected:!1},{value:"no_additional_properties",label:"No additional object properties",selected:!1},{value:"ajax",label:"Allow loading schemas via Ajax",selected:!1},{value:"disable_edit_json",label:'Disable "Edit JSON" buttons'},{value:"disable_collapse",label:"Disable collapse buttons",selected:!1},{value:"disable_properties",label:"Disable properties buttons",selected:!1},{value:"disable_array_add",label:"Disable array add buttons",selected:!1},{value:"disable_array_reorder",label:"Disable array move buttons",selected:!1},{value:"disable_array_delete",label:"Disable array delete buttons",selected:!1},{value:"enable_array_copy",label:"Add copy buttons to arrays",selected:!1},{value:"array_controls_top",label:"Array controls will be displayed at top of list",selected:!1},{value:"disable_array_delete_all_rows",label:"Disable array delete all rows buttons",selected:!1},{value:"disable_array_delete_last_row",label:"Disable array delete last row buttons",selected:!1}],jt=function(e){function t(e,a){var r;return Object(T.a)(this,t),(r=Object(P.a)(this,Object(R.a)(t).call(this,e,a))).onBooleanOptionsChange=r.onBooleanOptionsChange.bind(Object(N.a)(r)),r.onLayoutChange=r.onLayoutChange.bind(Object(N.a)(r)),r}return Object(q.a)(t,e),Object(M.a)(t,[{key:"onBooleanOptionsChange",value:function(e){for(var t=e.target.options,a={},r=0,n=t.length;r<n;r++)a[t[r].value]=t[r].selected;this.props.onChange(Object(Z.a)({},this.props,{booleanOptions:a,counter:(this.props.options.counter||0)+1}))}},{key:"onLayoutChange",value:function(e){this.props.onChange(Object(Z.a)({},this.props.options,{layout:e.target.value,counter:(this.props.options.counter||0)+1}))}},{key:"render",value:function(){return n.a.createElement($.a,null,n.a.createElement(V.a,null,"Boolean options"),n.a.createElement(B.a,null,n.a.createElement(ae.a,{type:"select",multiple:!0,size:"11",defaultValue:[],onChange:this.onBooleanOptionsChange},yt.map(function(e,t){return n.a.createElement("option",{key:t,value:e.value},e.label)}))),n.a.createElement(z.a,null,n.a.createElement(te.a,null,n.a.createElement(re.a,{addonType:"prepend"},"Object layout:"),n.a.createElement(ae.a,{type:"select",value:this.props.options.layout,onChange:this.onLayoutChange},n.a.createElement("option",{value:"normal"},"normal"),n.a.createElement("option",{value:"grid"},"grid")))))}}]),t}(r.Component),vt=function(e){e.children;return n.a.createElement("div",null,!1)},wt=function(e){function t(e,a){var r;return Object(T.a)(this,t),r=Object(P.a)(this,Object(R.a)(t).call(this,e,a)),H.a.defaults.options.iconlib="fontawesome5",H.a.defaults.options.theme="bootstrap4",r.updateMetaSchema=r.updateMetaSchema.bind(Object(N.a)(r)),r.updatePreviewSchema=r.updatePreviewSchema.bind(Object(N.a)(r)),r.updateOptions=r.updateOptions.bind(Object(N.a)(r)),r.schemaEditor=null,r.editorPreview=null,r.defaultValue={type:"object",properties:{Date:{type:"string",format:"datetime-local"},Status:{type:"string",enum:["Minor","Major","Critical"]},Description:{type:"string",format:"textarea"}},title:"Machinery Failure",format:"grid"},r.state={metaSchema:ct,previewSchema:null,options:{layout:H.a.defaults.options.object_layout,booleanOptions:{}}},r}return Object(q.a)(t,e),Object(M.a)(t,[{key:"updatePreviewSchema",value:function(e){console.log("preview update"),this.setState({previewSchema:e})}},{key:"updateOptions",value:function(e){console.log("options update"),this.setState({options:e})}},{key:"updateMetaSchema",value:function(e){console.log("editor update"),this.setState({metaschema:e})}},{key:"render",value:function(){return n.a.createElement("div",{className:Object(p.css)(lt.main)},n.a.createElement(h.a,{fluid:!0},n.a.createElement(F.a,null,n.a.createElement(A.a,{md:6},n.a.createElement(mt,{schema:this.state.metaSchema,onChange:this.updatePreviewSchema,options:this.state.options,defaultValue:this.defaultValue})),n.a.createElement(A.a,{md:6},n.a.createElement(ht,{schema:this.state.previewSchema}))),n.a.createElement(vt,null,n.a.createElement("div",{className:Object(p.css)(lt.devSection)},n.a.createElement(F.a,null,n.a.createElement(A.a,{md:6},n.a.createElement(jt,{options:this.state.options,onChange:this.updateOptions})),n.a.createElement(A.a,{md:6},n.a.createElement(bt,{value:this.state.metaSchema,onSchemaSubmit:this.updateMetaSchema})))))))}}]),t}(r.Component),Ot=function(e){function t(e,a){var r;return Object(T.a)(this,t),(r=Object(P.a)(this,Object(R.a)(t).call(this,e,a))).check=r.check.bind(Object(N.a)(r)),r.messagesFiltersInitialized=!1,r.messagesViewsInitialized=!1,r.state={done:!1},r}return Object(q.a)(t,e),Object(M.a)(t,[{key:"check",value:function(){this.messagesFiltersInitialized&&this.messagesViewsInitialized&&this.setState({done:!0})}},{key:"componentWillMount",value:function(){this.checkMessages()}},{key:"checkMessages",value:function(){this.checkFilter(Re,Ne,Object.keys(Re)),this.checkView(Te,Object.keys(Te))}},{key:"checkFilter",value:function(e,t,a,r){var n=this;if(r||(r=0),!a.length||a.length<=r)return this.messagesFiltersInitialized=!0,this.check(),!1;var i=Ie(a[r],!1,{live:!1}),s="_design/"+t+a[r];i.get(s).then(function(o){var l=!0;o.filters?Object.keys(e[a[r]]).forEach(function(t){o.filters[t]&&e[a[r]][t]===o.filters[t]||(l=!1)}):l=!1,l?n.checkFilter(e,t,a,r+1):(console.log("Updateing Filters ".concat(s)),i.put(Object(Z.a)({},o,{filters:e[a[r]]})).then(function(){console.log("Updateing Filters ".concat(s," (success)")),n.checkFilter(e,t,a,r+1)}))}).catch(function(o){404===o.status&&(console.log("Creating Filters ".concat(s)),i.put({_id:s,filters:e[a[r]]}).then(function(){console.log("Creating Filters ".concat(s," (success)")),n.checkFilter(e,t,a,r+1)}))})}},{key:"checkView",value:function(e,t,a){var r=this;if(a||(a=0),!t.length||t.length<=a)return this.messagesViewsInitialized=!0,this.check(),!1;var n="_design/"+t[a],i=Ie(t[a],!1,{live:!1});i.get(n).then(function(s){var o=!0;s.views?Object.keys(e[t[a]]).forEach(function(r){s.views[r]&&e[t[a]][r].map===s.views[r].map||(o=!1)}):o=!1,o?r.checkView(e,t,a+1):(console.log("Updateing Views ".concat(n)),i.put(Object(Z.a)({},s,{views:e[t[a]]})).then(function(){console.log("Updateing Views ".concat(n," (success)")),r.checkView(e,t,a+1)}))}).catch(function(s){var o=s.status;console.log("test",o),404===o&&(console.log("Creating Views ".concat(n)),i.put({_id:n,views:e[t[a]]}).then(function(){console.log("Views Filters ".concat(n," (success)")),r.checkView(e,t,a+1)}))})}},{key:"render",value:function(){return n.a.createElement("div",null,this.state.done&&this.props.children)}}]),t}(r.Component),Et=function(e){var t=e.initStore,a=e.children;return t(),n.a.createElement("div",null,a)},kt=Object(o.b)(function(e){return{}},function(e){return{initStore:function(){e({type:"INIT",payload:{}})}}})(Et),_t=function(e){var t=e.store;return n.a.createElement(o.a,{store:t},n.a.createElement(kt,null,n.a.createElement(Ot,null,n.a.createElement(l.a,null,n.a.createElement(c.a,null,n.a.createElement(u.a,{exact:!0,path:"/",component:ot}),n.a.createElement(u.a,{path:"/json-schema-editor",component:wt}))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(312),a(313),a(314),a(315);var St=a(28),xt=a(33),Ct=[],It=Ie("chats"),Dt=Object(xt.persistentReducer)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ct,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case w:return[].concat(Object(Ze.a)(e),[t.payload.chat]);case O:return e.filter(function(e){return e.id!==t.payload});default:return e}},{db:It,name:"chats"}),Tt={type:"object",format:"grid",required:["from","to","title"],properties:{from:{type:"string",enum:X.filter(function(e){return e.options.addChatIdToChatFromArray}).map(function(e){return e.chatId})},to:{type:"string",enum:X.filter(function(e){return e.options.addChatIdToChatToArray}).map(function(e){return e.chatId})},title:{type:"string",description:"Title for this message"}}},Mt=[{scheme:"height",title:"PersonHeight",properties:{height:{type:"integer",default:12}}},{scheme:"weight",title:"PersonWeight",properties:{weight:{type:"integer",default:12}}},{scheme:"color",title:"PersonColor",properties:{color:{type:"string",format:"color"}}},{scheme:"name",title:"PersonName",properties:{name:{type:"string",format:"string"}}}],Pt=function(){return Mt.map(function(e){return Object(Z.a)({},Tt,{scheme:e.scheme,title:e.title,properties:Object(Z.a)({},Tt.properties,e.properties),required:[].concat(Object(Ze.a)(Tt.required),[e.scheme])})})}(),Rt=Ie("message-types"),Nt=Object(xt.persistentReducer)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pt;return(arguments.length>1?arguments[1]:void 0).type,e},{db:Rt,name:"message-types"}),qt=Ie("messages",!0),Ft={},At=function(e){return(new Date).toISOString()+"-"+(e||"0")},$t=function(e){return e.map(function(e,t){return Object(Z.a)({},e,{_id:At(t),draft:!1})})},Vt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ft,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case g:var a=$t(t.payload.messages);return 1===a.length?qt.put(a[0]):qt.bulkDocs(a),e;case f:return qt.allDocs().then(function(e){return Promise.all(e.rows.map(function(e){return-1===e.id.search("_design")&&qt.remove(e.id,e.value.rev)}))}),{};case b:return Object(Z.a)({},e,Object(Ye.a)({},t.payload.chatId,t.payload.messages));case y:var r=Object(Z.a)({},$t([t.payload.message])[0],{draft:!0});return t.payload.message._id&&(r._id=t.payload.message._id),t.payload.message._rev&&(r._rev=t.payload.message._rev),qt.put(r),e;case j:return qt.get(t.payload.message._id).then(function(e){qt.bulkDocs([Object(Z.a)({},$t([t.payload.message])[0],{_rev:""}),Object(Z.a)({},e,{_deleted:!0})])}),e;default:return e}},Bt={points:[],activeRewind:null},Ut=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Bt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case S:return Object(Z.a)({},e,{points:t.payload.points});default:return e}},Wt=Object(St.combineReducers)({chats:Dt,messageTypes:Nt,messages:Vt,rewindPoints:Ut}),zt=a(274),Lt=a(275),Gt=function(e,t){return new Promise(function(a,r){var n=Yt(),i=t.name+"-rewind-"+n,s=Ie(i);s.replicate.from(e,{live:!1,retry:!1,filter:"filtermessages/cloneFilter"}).on("complete",function(e){if(console.log("success",e),t.remote){var r=t.remote+"-rewind-"+n;Ie(r).replicate.from(s,{live:!1,retry:!1}).on("complete",function(e){a({_id:n,local:i,remote:!0})}).on("error",function(e){console.log("Error on remote database sync, created only local db"),console.log(e),a({_id:n,local:i,remote:!1})})}else a({_id:n,local:i,remote:!1})}).on("error",function(e){console.log("Error on local db clone"),console.log(e),r()})})},Ht=function(e,t){Jt(e,t)},Jt=function(e,t){e.allDocs({include_docs:!0}).then(function(e){var a=e.rows;console.log(a),t.dispatch({type:S,payload:{points:a}})})},Yt=function(e){return(new Date).toISOString()+"-"+(e||"0")},Zt=function(e){return Object(Z.a)({},e,{active:!1,roomId:""})},Kt=function(e,t,a,r,n){switch(a.type){case"INIT":Ht(r,e);break;case E:Gt(n,Ce.messages).then(function(t){r.put(Object(Z.a)({},Zt(a.payload),t)).then(function(t){Jt(r,e)})});break;case _:r.allDocs({include_docs:!0}).then(function(t){var n=t.rows.filter(function(e){return e.doc.active||e.doc._id===a.payload.id}).map(function(e){return Object(Z.a)({},e.doc,{active:!e.doc.active})});r.bulkDocs(n).then(function(){Jt(r,e)})});break;default:return!1}return!0},Xt=Ie("rewind-points"),Qt=Ie("messages",!1),ea=function(e){return function(t){return function(a){Kt(e,t,a,Xt,Qt)||t(a)}}},ta=Object(St.applyMiddleware)(zt.a,ea);console.log("prod");var aa=Ie("main"),ra=Object(Lt.composeWithDevTools)(ta,Object(xt.persistentStore)({db:aa}))(St.createStore)(Wt);s.a.render(n.a.createElement(_t,{store:ra}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[276,1,2]]]);
//# sourceMappingURL=main.90c6c0b6.chunk.js.map